<!DOCTYPE HTML>
<!--
    Strongly Typed 1.0 by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
  <meta charset="utf-8">
  <title>Documents in Lucene.Net - LINQ to Fail</title>
  <meta name="author" content="Aaron Powell">
  <meta name="viewport" content="width=1040" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Arvo:700" rel="stylesheet" type="text/css" />
  <link href="/css/highlightjs/solarized_light.css" rel="stylesheet" type="text/css" />
  <script src="/js/jquery-1.9.1.min.js"></script>
  <script src="/js/jquery.dropotron-1.3.js"></script>
  <script src="/js/config.js"></script>
  <script src="/js/skel.min.js"></script>
  <script src="/js/skel-ui.min.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/skel-noscript.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/style-desktop.css" />
  </noscript>
  <!--[if lte IE 8]><script src="/js/html5shiv.js"></script><![endif]-->

</head>

    <body class="left-sidebar">

        <div id="header-wrapper">
            <div id="header" class="container">
                <h1 id="logo">Documents in Lucene.Net</h1>
                <h2>3rd July 2010</h2>
                <ul class="tags">
    
        
            <li><a class="icon icon-tag" href="/tagged/lucene-net.html"><span>lucene.net</span></a></li>
        
            <li><a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a></li>
        
    
</ul>
                <!-- Nav -->
<nav id="nav">
    <ul>
        <li><a class="icon icon-home" href="/"><span>Home</span></a></li>
        <li><a class="icon icon-github" href="https://github.com/aaronpowell"><span>aaronpowell</span></a></li>
        <li><a class="icon icon-twitter" href="http://twitter.com/slace"><span>@slace</span></a></li>
        <li><a class="icon icon-book" href="/about"><span>About Me</span></a></li>
        <li><a class="icon icon-rss" href="/feed"><span>Feed</span></a></li>
    </ul>
</nav>

            </div>
        </div>

        <div id="main-wrapper">
            <div id="main" class="container">
                <div class="row">
                    <div id="sidebar" class="4u">
    <section>
        <ul class="divided">
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">24th September 2012</span>
                            <h3><a href="/posts/2012-09-24-check-if-file-exists.html">How to check if a file exists in Windows 8</a></h3>
                        </header>
                        <p>Ever wondered how to check if a file exists in Windows 8?</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/windows8.html"><span>windows8</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/winjs.html"><span>winjs</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/winrt.html"><span>winrt</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">5th September 2012</span>
                            <h3><a href="/posts/2012-09-05-text-casing-and-examine.html">Text casing and Examine</a></h3>
                        </header>
                        <p>A few times I&#39;ve seen questions posted on the Umbraco forums which ask how to deal with case insensitivity text with Examine, and itâ€™s also something that we&#39;ve had to handle a few times within our...</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/lucene-net.html"><span>lucene.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/examine.html"><span>examine</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/umbraco.html"><span>umbraco</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">28th August 2010</span>
                            <h3><a href="/posts/2010-08-28-testable-email-sending.html">Testable email sending</a></h3>
                        </header>
                        <p>Creating an integration test of sending an email</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/testing.html"><span>testing</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">5th July 2010</span>
                            <h3><a href="/posts/2010-07-05-dynamics-library.html">Dynamics Library</a></h3>
                        </header>
                        <p>A series of helper methods for working with the DLR in C# 4.0</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/dynamic.html"><span>dynamic</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">28th June 2010</span>
                            <h3><a href="/posts/2010-06-28-dynamic-dictionaries-with-csharp-4.html">Dynamic Dictionaries with C# 4.0</a></h3>
                        </header>
                        <p>Using the C# dynamic features to make it easier to work with Dictionary objects</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/dynamic.html"><span>dynamic</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/umbraco.html"><span>umbraco</span></a>
                            
                        </div>
                    </article>
                </li>
            
        </ul>
    </section>
</div>

                    <div id="content" class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <p>As you&#39;re most likely already aware Lucene.Net is a Document Database, which means that it&#39;s essentially a key/ value store, with the crux of the interaction through <em>Documents</em></p>
<h2>But what is a Document?</h2>
<p>What needs to be understood about the Document concept in Lucene.Net is that is doesn&#39;t have anything to do with a file, it&#39;s not a PDF, a DOCX, or a XLSX. It&#39;s just a key/ value store. As I pointed out in my <a href="/lucene-net-overview">overview of Lucene.Net</a> this framework is agnostic of anything like that.</p>
<p>But unlike other Document Databases, such as <a href="http://ravendb.net/">RavenDB</a>, Lucene.Net doesn&#39;t allow you to put just an object into itself, you need to do it via a Document. Once a Document is inserted into the Lucene index it is then given a unique identifier (a numerical ID) and the data on the Document is stored.</p>
<h2>Data on a Document</h2>
<p>When pushing the data into a Lucene index it is done via Fields. A Field is <em>a key/ value pair</em> if you want to get a very high view of it, but it&#39;s really a bit more powerful that that. It&#39;s true that it&#39;s primary responsibility is to push data into Lucene with a string key and a string value, and providing information to Lucene about how to store that data in the index.</p>
<p>When you&#39;re adding a Field to Lucene.Net you need to work out which of the available constructors to use, as there are 9 (yes, 9!) different choices. Personally I like this particular constructor:</p>
<pre class="highlighted"><code class="cs"><span class="keyword">public</span> Field(<span class="keyword">string</span> name, <span class="keyword">string</span> <span class="keyword">value</span>, Store store, Index index)</code></pre>
<p>I find that it gives the most flexibility and is the most obvious as to what it&#39;s doing (it&#39;s not the one which we use internal of <a href="http://examine.codeplex.com">Examine</a> we actually use a different one as we want to work with TermVectors).</p>
<p>On top of the name (key) and value parameters there are also three others, Store, Index and TermVector. Each of these are used to define how the data is handled within the Lucene index.</p>
<p>Also, this is where we start getting in to the part of Lucene.Net that I <strong>really</strong> don&#39;t like, static fields (I miss enums...).</p>
<h3>Store</h3>
<p>When first coming across Lucene the point of <code>Field.Store</code> is a bit confusion, it has two options, YES and NO (ok, it does have a third, COMPRESS, but it&#39;s been deprecated in the Java version of Lucene and replaced by a separate API which is available in Lucene.Net - <code>Lucene.Net.Documents.CompressionTools</code>).</p>
<p>Initially looking at these two options is confusion, why would you be putting the data Field if you don&#39;t want it stored? Seems a bit strange... But it comes down to what you&#39;re using Lucene.Net for, and having an understanding of that will give you an understanding of what you need to set as your Field.Store value.</p>
<p>If you&#39;re using Lucene.Net as a full storage model, a completely replacement of another storage model (such as a relational database) then you want to set it to Store.YES. This tells Lucene to store the value of the field, not just the tokenized version of it.</p>
<p>If you are using Lucene.Net as just a search engine, and maintaining the actual data in a separate data store then you can get away with setting Store.NO. This means that when you are &#39;hydrating&#39; your entity from search you&#39;ll be going elsewhere to get the actual data that is required. Essentially doing a two-phase hydration, first finding your entities using Lucene, and then their data from your data store.</p>
<h3>Index</h3>
<p>The Index parameter allows you to specify how the data is treated when it&#39;s added to your Lucene index, and this will also effect the searching against it. Also selecting the right Index type will impact on the size of your index.</p>
<p>There are 5 types of indexing, let&#39;s start with the basic on, NO. This one is fairly obvious, and it does what you&#39;re expecting. If you set your field with an Index.NO value it&#39;s not going to be accessible via the Lucene searcher. If you&#39;re working directly with the Document object then you can get the data (provided it&#39;s Store.YES :P) it&#39;s accessible via the name of the Field.</p>
<p>There other options are about the analysis of the Field data in the index. I&#39;ve looked at <a href="/lucene-analyzer">Analyzers in the past</a> so hopefully it&#39;s a concept your familiar with. Again, choosing the right option here will impact on the size of the index.</p>
<p>Here&#39;s a few good rules on whether to use analysis or not with your Field:</p>
<ul>
<li>Analyze if:<ul>
<li>The value contains multiple keywords</li>
<li>The data is to be searched using multiple different ways (such as fuzzy, boosting, etc)</li>
<li>The data does not need to be sorted against</li>
</ul>
</li>
<li>Don&#39;t analyze if:<ul>
<li>The value will only be a single word (and not a fuzzy word)</li>
<li>The value contains multiple words but requires sorting</li>
</ul>
</li>
</ul>
<p>NORMS/ NO_NORMS really comes down to what you need to do with the value when you&#39;re searching. If you use NO_NORMS then the value isn&#39;t normalized and features such as boost and string-length wont be enabled.</p>
<p><a href="/building-an-application-with-lucene-net">In this article I&#39;ve had a look at how the <code>Field.Store</code> and <code>Field.Index</code> can be used to make a simple application using Lucene.Net</a>.</p>
<h3>TermVector</h3>
<p>I thought I&#39;d cover this even through I tend to let the default (<code>TermVector.NO</code>) get used. TermVector is used to indicate if you want to have metadata about the <em>terms</em> which you&#39;re putting into your index. A term is the value (or values if it&#39;s an analyzed Field).</p>
<p>This can be handy if you want to know whether what&#39;s being put into the index contains the same term multiple times, and potentially getting false-positives in your search. It allows you to see how many times a term exists in a Document (<code>TermVector.YES</code>), or you can go one step further and have to stored the position in the Field value which the term appears (<code>TermVector.WITH_POSITIONS</code>) or an offset for where the term appears in the value (<code>TermVector.WITH_OFFSET</code>) and lastly you can go all out with <code>TermVector.WITH_POSITIONS_OFFSETS</code>.</p>
<p>Use this sparingly, as it can blow out the size of your index if you store everything about everything!</p>
<h2>Conclusion</h2>
<p>So to finish off this time we&#39;ve looked at the Document side of a Document Database. Understanding Documents and Fields will allow you to start getting the full power out of the Lucene.Net API.</p>

                        </article>
                    </div>
                    <div class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <div id="disqus_thread"></div>
<script>
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
window.disqus_shortname = 'aaronpowell'; // required: replace example with your forum shortname
window.disqus_identifier = document.title || 'Home';
window.disqus_developer = !! ~document.location.href.indexOf("localhost") ? 1 : 0;
window.disqus_url = document.location.origin + '/documents-in-lucene-net';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by</a>
<span class="logo-disqus"> Disqus</span>

                        </article>
                    </div>
                </div>
            </div>
        </div>

        <div id="footer-wrapper">

    <!-- Copyright -->
        <div id="copyright" class="container">
            <ul class="links">
                <li>&copy; Aaron Powell. All rights reserved</li>
                <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
            </ul>
        </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6399564-1']);
  _gaq.push(['_trackPageview']);

  (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script>

    </body>
</html>