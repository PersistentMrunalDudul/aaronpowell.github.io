<!DOCTYPE HTML>
<!--
    Strongly Typed 1.0 by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
  <meta charset="utf-8">
  <title>Are Extension Methods Really Evil? - LINQ to Fail</title>
  <meta name="author" content="Aaron Powell">
  <meta name="viewport" content="width=1040" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Arvo:700" rel="stylesheet" type="text/css" />
  <link href="/css/highlightjs/solarized_light.css" rel="stylesheet" type="text/css" />
  <script src="/js/jquery-1.9.1.min.js"></script>
  <script src="/js/jquery.dropotron-1.3.js"></script>
  <script src="/js/config.js"></script>
  <script src="/js/skel.min.js"></script>
  <script src="/js/skel-ui.min.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/skel-noscript.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/style-desktop.css" />
  </noscript>
  <!--[if lte IE 8]><script src="/js/html5shiv.js"></script><![endif]-->

</head>

    <body class="left-sidebar">

        <div id="header-wrapper">
            <div id="header" class="container">
                <h1 id="logo">Are Extension Methods Really Evil?</h1>
                <h2>8th April 2010</h2>
                <ul class="tags">
    
        <li><a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/extension-methods.html"><span>extension-methods</span></a></li>
    
</ul>
                <!-- Nav -->
<nav id="nav">
    <ul>
        <li><a class="icon icon-home" href="/"><span>Home</span></a></li>
        <li><a class="icon icon-github" href="https://github.com/aaronpowell"><span>aaronpowell</span></a></li>
        <li><a class="icon icon-twitter" href="http://twitter.com/slace"><span>@slace</span></a></li>
        <li><a class="icon icon-book" href="/about"><span>About Me</span></a></li>
        <li><a class="icon icon-rss" href="/feed"><span>Feed</span></a></li>
    </ul>
</nav>

            </div>
        </div>

        <div id="main-wrapper">
            <div id="main" class="container">
                <div class="row">
                    <div id="sidebar" class="4u">
    <section>
        <ul class="divided">
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">27th May 2010</span>
                            <h3><a href="/posts/2010-05-27-lucene-analyzer.html">Analyzers in Lucene.Net</a></h3>
                        </header>
                        <h2>What is an Analyzer?</h2>
<p>When you want to insert data into a Lucene index, or when you want to get the data back out of the index you will need to use an Analyzer to do this.</p>
<p>Lucene ships with ma...</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/lucene-net.html"><span>lucene.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/examine.html"><span>examine</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/umbraco-examine.html"><span>umbraco-examine</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">19th May 2009</span>
                            <h3><a href="/posts/2009-05-19-query-syntax-vs-method-syntax.html">Query Syntax vs Method Syntax</a></h3>
                        </header>
                        <p>What&#39;s the difference with LINQ to using query syntax to pure lambda expressions?</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/linq.html"><span>linq</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">7th April 2010</span>
                            <h3><a href="/posts/2010-04-07-csharp.html">C#/ .NET</a></h3>
                        </header>
                        <p>Source of all that I&#39;ve written about in the .NET world</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">14th April 2010</span>
                            <h3><a href="/posts/2010-04-14-lucene-net-overview.html">An overview of Lucene.Net</a></h3>
                        </header>
                        <p>Overview and table-of-contents for Lucene.Net articles</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/lucene-net.html"><span>lucene.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/examine.html"><span>examine</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/umbraco-examine.html"><span>umbraco-examine</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">25th April 2010</span>
                            <h3><a href="/posts/2010-04-25-dealing-with-type-casting-limitations.html">Dealing with type-casting limitations</a></h3>
                        </header>
                        <p>Looking at a limit with type casting in .NET 3.5 and how .NET 4.0 can help solve it.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-4.html"><span>c#-4</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/dynamic.html"><span>dynamic</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/type-casting.html"><span>type-casting</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/umbraco.html"><span>umbraco</span></a>
                            
                        </div>
                    </article>
                </li>
            
        </ul>
    </section>
</div>

                    <div id="content" class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <p>Ruben (of Umbraco fame) recently wrote a post entitled Extension Methods: Silent static slaves which was in response to a comment I&#39;d left on a previous post about static classes and static method being evil.</p>
<p>If you haven&#39;t read Ruben post then I suggest you do before continue on with mine as a lot of what I&#39;ll be saying is in counter argument to him (including the comments).</p>
<p>Done? Good, continue on!</p>
<p>Ruben has produced a demo which is great for illistrating his point, but is it an example of good design turning bad or just bad design from the start?</p>
<p>The first thing I want to look at is that his extension methods are on the interface and implementation class.
This is bad design to start with, but it&#39;s not just bad design if you&#39;re using extension methods, this could manifest itself as bad design if you did it as helper methods in a separate class, eg:</p>
<pre class="highlighted"><code class="java"><span class="class"><span class="keyword">class</span> <span class="title">Helpers</span> {</span>
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> CalculateShoeCount(Animal animal) {
   <span class="comment">//do processing</span>
  }
  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> CalculateShoeCount(Monkey animal) {
   <span class="comment">//do processing</span>
  }
}</code></pre>
<p>So this would fall into the same trap if we don&#39;t re-cast Animal to Monkey before calling the helper.</p>
<p>But does this prove Ruben&#39;s initial point, that static&#39;s are just plain evil?
Well no, design isn&#39;t possible without statics. If you try and design without statics you end up with nothing but instance memebers. If that&#39;s the case where do I find the current method int.TryParse, does this become 0.TryParse?</p>
<p>Ruben&#39;s demo is an example of bad design producing worse design. In good design the CalculateShoeCount would be a member of the Animal interface, particularly since the implementation changes per interface implementation type.</p>
<p>So how can we use extension methods to produce good design? Well first you really need to understand what an extension method is. As Ruben quite correctly pointed out an extension is just syntactic suger and extension methods should be treated as such. Developers need to understand that extension methods are only designed to provide functionality to a classes public instance members; they are stateless.
(This is why I don&#39;t understand why so many people of Stack Overflow want extension properties added to the compiler, this is where people are missing the point of the extension concept)
And if you&#39;re expecting a stateful nature from the extension methods then you&#39;ve missed their goal.</p>
<p>Lets look at some good examples of using extension methods. Here&#39;s a fav of mine for Umbraco:</p>
<pre class="highlighted"><code class="objectivec"><span class="keyword">public</span> <span class="keyword">static</span> string Url(<span class="keyword">this</span> Node node) {
  <span class="keyword">return</span> umbraco<span class="variable">.library</span><span class="variable">.NiceUrl</span>(node<span class="variable">.Id</span>);
}</code></pre>
<p>(Hey look, a static calling a static ;)).</p>
<p>Or how about this one:</p>
<pre class="highlighted"><code class="objectivec"><span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;ListItem&gt; SelectedItems(<span class="keyword">this</span> ListControl ctrl) {
  <span class="keyword">return</span> ctrl<span class="variable">.Items</span><span class="variable">.Cast</span>&lt;ListItem&gt;()<span class="variable">.Where</span>(item =&gt; item<span class="variable">.Selected</span>);
}</code></pre>
<p>Now we&#39;re using an extension method with an extension method.</p>
<p>But both of these examples are using actual class implementations, not interfaces, does that make a difference?
Yes, and a big one. When you are putting extensions on an interface there needs to be no possibility of confusion about what the extensions are for. And if you are also providing an extension of an implementation of the class they need to be in separate namespaces. If they aren&#39;t, you will end up with what Ruben shows, misrepresentation of the methods abilities.</p>
<p>IQueryable<T> is a perfect example of how to use extension methods on top of an interface. If you have a look at the construct of the interface there&#39;s actually no constructs within it! This means that &quot;all&quot; the functionality is provided by extension methods, allowing anyone to write their own extensions.
If I was to not include the namespace System.Linq I can then write my own query extensions, eg a Where that does return a bool, or negate operators which I don&#39;t want to support.</p>
<p>So in my opinion extension methdos are no more evil than anything else in programming; they can easily be abused and misused, but find something that it&#39;d not possible to misuse to prove bad design.</p>

                        </article>
                    </div>
                    <div class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <div id="disqus_thread"></div>
<script>
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
window.disqus_shortname = 'aaronpowell'; // required: replace example with your forum shortname
window.disqus_identifier = document.title || 'Home';
window.disqus_developer = !! ~document.location.href.indexOf("localhost") ? 1 : 0;
window.disqus_url = document.location.origin + '/are-extension-methods-really-evil';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by</a>
<span class="logo-disqus"> Disqus</span>

                        </article>
                    </div>
                </div>
            </div>
        </div>

        <div id="footer-wrapper">

    <!-- Copyright -->
        <div id="copyright" class="container">
            <ul class="links">
                <li>&copy; Aaron Powell. All rights reserved</li>
                <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
            </ul>
        </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6399564-1']);
  _gaq.push(['_trackPageview']);

  (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script>

    </body>
</html>