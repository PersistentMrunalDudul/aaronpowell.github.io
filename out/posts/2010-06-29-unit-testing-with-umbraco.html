<!DOCTYPE HTML>
<!--
    Strongly Typed 1.0 by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
  <meta charset="utf-8">
  <title>Unit Testing with Umbraco | LINQ to Fail</title>
  <meta name="author" content="Aaron Powell">
  <meta name="viewport" content="width=1040" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Arvo:700" rel="stylesheet" type="text/css" />
  <link href="/css/highlightjs/solarized_light.css" rel="stylesheet" type="text/css" />
  <script src="/js/jquery-1.9.1.min.js"></script>
  <script src="/js/jquery.dropotron-1.3.js"></script>
  <script src="/js/config.js"></script>
  <script src="/js/skel.min.js"></script>
  <script src="/js/skel-ui.min.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/skel-noscript.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/style-desktop.css" />
  </noscript>
  <!--[if lte IE 8]><script src="/js/html5shiv.js"></script><![endif]-->

</head>

    <body class="left-sidebar">

        <div id="header-wrapper">
            <div id="header" class="container">
                <h1 id="logo">Unit Testing with Umbraco</h1>
                <h2>29th June 2010</h2>
                <ul class="tags">
    
        <li><a class="icon icon-tag" href="/tagged/umbraco.html"><span>umbraco</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/asp-net.html"><span>asp.net</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/unit-testing.html"><span>unit-testing</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/webformsmvp.html"><span>webformsmvp</span></a></li>
    
</ul>
                <!-- Nav -->
<nav id="nav">
    <ul>
        <li><a class="icon icon-home" href="/"><span>Home</span></a></li>
        <li><a class="icon icon-github" href="https://github.com/aaronpowell"><span>aaronpowell</span></a></li>
        <li><a class="icon icon-twitter" href="http://twitter.com/slace"><span>@slace</span></a></li>
        <li><a class="icon icon-book" href="/about"><span>About Me</span></a></li>
        <li><a class="icon icon-rss" href="/feed"><span>Feed</span></a></li>
    </ul>
</nav>

            </div>
        </div>

        <div id="main-wrapper">
            <div id="main" class="container">
                <div class="row">
                    <div id="sidebar" class="4u">
    <section>
        <ul class="divided">
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">27th November 2010</span>
                            <h3><a href="/posts/2010-11-27-umbraco-ironruby-tips-and-tricks.html">Some tips and tricks for working with IronRuby and Umbraco</a></h3>
                        </header>
                        <p>Some things which I&#39;ve learnt while working with IronRuby in Umbraco</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/umbraco.html"><span>umbraco</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/ironruby.html"><span>ironruby</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">8th January 2013</span>
                            <h3><a href="/posts/2013-01-08-the-problem-with-assert-istrue.html">The problem with Assert.IsTrue</a></h3>
                        </header>
                        <p>It&#39;s time for another rant, this time it&#39;s with how some people write their unit tests</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/unit-testing.html"><span>unit-testing</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/opinionated.html"><span>opinionated</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/ranting.html"><span>ranting</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/rant.html"><span>rant</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">11th July 2012</span>
                            <h3><a href="/posts/2012-07-11-using-mvc-in-umbraco-4-revisited.html">Revisiting using ASP.NET MVC in Umbraco 4</a></h3>
                        </header>
                        <p>An update on using ASP.NET MVC with Umbraco 4.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/umbraco.html"><span>umbraco</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/asp-net-mvc.html"><span>asp.net-mvc</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">25th June 2012</span>
                            <h3><a href="/posts/2012-06-25-i-helped-kill-umbraco-5.html">I helped kill Umbraco 5</a></h3>
                        </header>
                        <p>Hi, my name&#39;s Aaron Powell and I was involved in killing Umbraco 5.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/umbraco.html"><span>umbraco</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/umbraco-5.html"><span>umbraco-5</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/opinionated.html"><span>opinionated</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">13th June 2012</span>
                            <h3><a href="/posts/2012-06-13-introducing-umbraco-contributor-list.html">Introducing the Umbraco contributor mailing list</a></h3>
                        </header>
                        <p>Keen discuss contributing to Umbraco&#39;s core, join the discussion now!</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/umbraco.html"><span>umbraco</span></a>
                            
                        </div>
                    </article>
                </li>
            
        </ul>
    </section>
</div>

                    <div id="content" class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <p>At <a href="/codegarden-10">CodeGarden 10</a> I did a presentation on Unit Testing with Umbraco which was primarily looking at doing Unit Testing with ASP.NET and then have you can take those principles into doing development with Umbraco.</p>
<p>Unfortunately the session ran way over time, but we have a good open space the following morning to look deeper into the stuff I didn&#39;t have a chance to cover.</p>
<p>The crux of my session was around using <a href="http://webformsmvp.com">ASP.NET WebForms MVP</a> which I&#39;ve doing <a href="/webforms-mvp">articles on in the past</a>, including how to do presenters in F# :P.</p>
<h2>Unit Testing with Umbraco</h2>
<p>When doing unit testing with Umbraco there&#39;s a few things you need to take into account:</p>
<ul>
<li>Reliance on the HttpContext</li>
<li>Static methods</li>
</ul>
<p>Because of these things it&#39;s quite hard to stub out a type which is reliant on static methods it&#39;s quite a tricky thing, you really need to use some kind of an isolation framework like <a href="http://www.typemock.com">Typemock</a>. And if you&#39;re relying on the HttpContext then you need to either spin up Cassini/ IIS, or try and mock it out.</p>
<p>NodeFactory is a tricky beast, it expects the XML cache, so if you don&#39;t have it where it thinks it should be, then it&#39;s not going to make your life easy.</p>
<h3>Looking into Snapshot</h3>
<p>In the past I&#39;ve blogged via my work blog, <a href="http://farmcode.org">FarmCode.org</a>, we&#39;re working on a new product called <a href="http://farmcode.org/page/Snapshot.aspx">Snapshot</a> which is designed to push out a plain ASP.NET website with no Umbraco reliances at all. During CodeGarden 10 we decided to release part of Snapshot for free, the CMS API, which is designed to abstract away the Umbraco aspect and gives you the ability to do unit testing.</p>
<p>Snapshot exposes most of what can be done with NodeFactory, Media and <code>umbraco.library</code>, but does so via interfaces. This means that they can be stubbed out and used for testing.</p>
<h2>Working with ASP.NET WebForms MVP</h2>
<p>So I wasn&#39;t just using the standard ASP.NET WebForms MVP install, I was also using the Contrib project which I contribute on. I was using this for the <a href="http://code.google.com/p/autofac">Autofac</a> integration, as I wanted to be able to dependency inject more than just the view.</p>
<h2>Resources from the presentation</h2>
<p>Here&#39;s what you&#39;ll need from my presentation to be able to dig into it yourself:</p>
<ul>
<li><a href="/get/umbraco/cg10/UnitTestableUmbraco-Slides.zip">Slide Deck</a></li>
<li><a href="/get/umbraco/cg10/CodeGarden10.zip">Source Code</a></li>
<li><a href="/unit-testing-with-umbraco/video">Video</a></li>
</ul>
<p>Hopefully this gives you a good start for doing unit testing your own Umbraco development.</p>

                        </article>
                    </div>
                    <div class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <div id="disqus_thread"></div>
<script>
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
window.disqus_shortname = 'aaronpowell'; // required: replace example with your forum shortname
window.disqus_identifier = document.title || 'Home';
window.disqus_developer = !! ~document.location.href.indexOf("localhost") ? 1 : 0;
window.disqus_url = document.location.origin + '/unit-testing-with-umbraco';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by</a>
<span class="logo-disqus"> Disqus</span>

                        </article>
                    </div>
                </div>
            </div>
        </div>

        <div id="footer-wrapper">

    <!-- Copyright -->
        <div id="copyright" class="container">
            <ul class="links">
                <li>&copy; Aaron Powell. All rights reserved</li>
                <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
            </ul>
        </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6399564-1']);
  _gaq.push(['_trackPageview']);

  (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script>

    </body>
</html>