<!DOCTYPE HTML>
<!--
    Strongly Typed 1.0 by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
  <meta charset="utf-8">
  <title>Client Event Pool - LINQ to Fail</title>
  <meta name="author" content="Aaron Powell">
  <meta name="viewport" content="width=1040" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Arvo:700" rel="stylesheet" type="text/css" />
  <link href="/css/highlightjs/solarized_light.css" rel="stylesheet" type="text/css" />
  <script src="/js/jquery-1.9.1.min.js"></script>
  <script src="/js/jquery.dropotron-1.3.js"></script>
  <script src="/js/config.js"></script>
  <script src="/js/skel.min.js"></script>
  <script src="/js/skel-ui.min.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/skel-noscript.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/style-desktop.css" />
  </noscript>
  <!--[if lte IE 8]><script src="/js/html5shiv.js"></script><![endif]-->

</head>

    <body class="left-sidebar">

        <div id="header-wrapper">
            <div id="header" class="container">
                <h1 id="logo">Client Event Pool</h1>
                <h2>23rd May 2010</h2>
                <ul class="tags">
    
        
            <li><a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a></li>
        
            <li><a class="icon icon-tag" href="/tagged/ajax.html"><span>ajax</span></a></li>
        
            <li><a class="icon icon-tag" href="/tagged/ms-ajax.html"><span>ms-ajax</span></a></li>
        
    
</ul>
                <!-- Nav -->
<nav id="nav">
    <ul>
        <li><a class="icon icon-home" href="/"><span>Home</span></a></li>
        <li><a class="icon icon-github" href="https://github.com/aaronpowell"><span>aaronpowell</span></a></li>
        <li><a class="icon icon-twitter" href="http://twitter.com/slace"><span>@slace</span></a></li>
        <li><a class="icon icon-book" href="/about"><span>About Me</span></a></li>
        <li><a class="icon icon-rss" href="/feed"><span>Feed</span></a></li>
    </ul>
</nav>

            </div>
        </div>

        <div id="main-wrapper">
            <div id="main" class="container">
                <div class="row">
                    <div id="sidebar" class="4u">
    <section>
        <ul class="divided">
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">6th September 2013</span>
                            <h3><a href="/posts/2013-09-06-linq-in-javascript-es6.html">LINQ in JavaScript, ES6 style</a></h3>
                        </header>
                        <p>It&#39;s been a few years since I last blogged about the concept of LINQ in JavaScript as a lot has changed in the JavaScript landscape.</p>
<p>So let&#39;s revisit the idea of it with a look at how you could leverage LINQ in JavaScript for ES6.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/linq.html"><span>linq</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/es6.html"><span>es6</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">22nd July 2013</span>
                            <h3><a href="/posts/2013-07-22-array-like-objects.html">Array-like objects</a></h3>
                        </header>
                        <p>Just because it looks like a duck, walks like a duck, quacks like a duck doesn&#39;t mean it&#39;s a duck. There&#39;s dangers with making assumptions of your JavaScript objects based on their surface area.</p>
<p>That said, a lot of power can be gleamed by these seemingly innocent assumptions.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">14th July 2013</span>
                            <h3><a href="/posts/2013-07-14-javascript-new-operator.html">The JavaScript new operator</a></h3>
                        </header>
                        <p>Time to revisit something that was overlooked in the last post, the <code>new</code> operator in JavaScript and what it does.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">10th July 2013</span>
                            <h3><a href="/posts/2013-07-10-implementing-indexers-in-javascript.html">Implementing "indexers" in JavaScript</a></h3>
                        </header>
                        <p>My colleague Luke Drumm challenged me to implement C# style indexers in JavaScript.</p>
<p>So let&#39;s have a look at how you can do that, and how you can make some very interesting JavaScript objects that are self replicating. We&#39;ll build on the knowledge of using <code>bind</code> and <code>apply</code> from the last two posts.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">5th July 2013</span>
                            <h3><a href="/posts/2013-07-05-javascript-binding-currying-and-arrows.html">JavaScript bind, currying and arrow functions</a></h3>
                        </header>
                        <p>After confusing my colleagues with how to invoke functions with a modifided set of arguments at a single time the next evolutionary point was to confuse them with creating functions that are always called with a different state.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
        </ul>
    </section>
</div>

                    <div id="content" class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <p>I read an article last year about implementing a <a href="http://seejoelprogram.wordpress.com/2008/07/31/a-client-event-pool-in-javascript/">Client Event Pool</a> and I really liked the concept. Joel shows a very good way to use it but I&#39;ve been doing my best to find a logical use for it myself.</p>
<p>Anyone not familiar with the concept of a Client Event Pool it&#39;s covered in Joel&#39;s post, but the short version is that a Client Event Pool is a browser-level event handler which is designed to allow events to be easily passed between unlinked components.
One component can raise an event which can be chosen to be handled by any other. Inversly events can be listened for even if the component isn&#39;t on the page or the event isn&#39;t used.</p>
<p>This isn&#39;t really a new concept, you can achieve it (to a certain extent) with standard ASP.NET, with the OnClient<EventName> which is on a lot of the standard ASP.NET controls.</p>
<p>And in this article I&#39;m going to look at how to integrate a Client Event Pool with the ASP.NET AJAX Control Toolkit&#39;s Modal Popup.
Now, don&#39;t get me wrong, this isn&#39;t the only way to add the events to a modal popup control, there are a lot of event handlers which can be added without a Client Event Pool.</p>
<p>This all came about when I was tasked with integrating a login, forgotten password and change password component. Each were their own modal popups and each were separate .NET UserControls. I wasn&#39;t involved with developing any of them, and I didn&#39;t want to really do much to modify any of them too much and introduce more bugs in the system by screwing around with stuff I&#39;m not familiar with.
Because they are all separate I didn&#39;t have a real way to pass the ID of the control that was to make the popup appear. Oh, and to make thing more complicated there were 2 links for each popup, sadly the Modal Popup doesn&#39;t support multiple controls to do the poping-up (or as far as I&#39;m aware...)</p>
<p>I also didn&#39;t want each of the popups to overlay each other, it doesn&#39;t really look that good (as I&#39;ll show shortly), so I needed a way to hide the master popup when the child was shown, and then when the child was hidden I want the master to reappear.</p>
<p>So I&#39;m doing 3 basic controls for my example, a Login control:</p>
<p><img src="http://www.aaron-powell.com/get/media/1944/picture%201.jpg" alt=""><a href="http://www.aaron-powell.com/get/media/1944/picture%201.png">Full size</a></p>
<p>a Forgotten Password control:</p>
<p><img src="http://www.aaron-powell.com/get/media/1949/picture%202.jpg" alt=""><a href="http://www.aaron-powell.com/get/media/1949/picture%202.png">Full size</a></p>
<p>a Registration control:</p>
<p><img src="http://www.aaron-powell.com/get/media/1954/picture%203.jpg" alt=""><a href="http://www.aaron-powell.com/get/media/1954/picture%203.png">Full size</a></p>
<p>And add a dash of CSS and you get a lovely little popup:</p>
<p><img src="http://www.aaron-powell.com/get/media/1959/picture%204.png" alt=""></p>
<p>(Ok, so my design skills aren&#39;t great!)</p>
<p>So now it&#39;s time to tie up the master control with the child controls. To do this I&#39;m going to have 2 events raised from the child controls, one for when the popup is shown and one for when it is hidden.
I&#39;m also going to have an event which can be raised elsewhere on each child control which will initiate the showing of the popup (you could add one for the hiding, but I&#39;m using the inbuilt hiding from the CancelControlID property of the modal popup).</p>
<p>For each they will look as follows:</p>
<p><img src="http://www.aaron-powell.com/get/media/1969/picture%206.jpg" alt=""><a href="http://www.aaron-powell.com/get/media/1964/picture%205.png">Full size</a></p>
<p>Lets have a look at how they work, first off I locate the the <code>Sys.Component</code> instance of the ModalPopup control.
There are <code>showing</code> and <code>hiding</code> events fired off from the ModalPopup, so I&#39;m going to add a handler, the handler though will just be a stub which in-turn raises an event within our Client Event Pool. I&#39;ve given them names which will indicate what they are used for.
Lastly I&#39;m going to add an event handler so anyone can raise an event which will show the popup.</p>
<p>Now lets have a look in the Login control:</p>
<p><img src="http://www.aaron-powell.com/get/media/1979/picture%207.jpg" alt=""><a href="http://www.aaron-powell.com/get/media/1979/picture%207.png">Full size</a></p>
<p>The first 2 lines of this is adding event handlers to the links on the control. All they do is tell the Client Event Pool to raise an event, an event which I previously set up to be consumed by the child controls.</p>
<p>Next we set up the Client Event Pool to listen for the hide and show events from our child controls.
It listens for the events to be raised and when they are it&#39;ll either hide or show the modal on the current page.
Admittedly I&#39;ve gone a little bit overboard with my events between the two child controls. Each could just raise events like <code>hideParent</code> and <code>showParent</code>, and then I would only need 2 handlers against the Client Event Pool, but to illistrate my point I&#39;ve gone the verbos method.</p>
<p>Now I&#39;ve gone for having the popups showing like this:</p>
<p><img src="http://www.aaron-powell.com/get/media/1974/picture%208.png" alt=""></p>
<p>To this:</p>
<p><img src="http://www.aaron-powell.com/get/media/1984/picture%209.png" alt=""></p>
<p>Admittedly static images can&#39;t really show how it works, but it&#39;s much nicer to not overlay popups, and ability to having popups automatically hiding and showing the loss-of-focus ones is a really sweet idea.</p>
<p>I&#39;ll admit that it&#39;s possible to do this without the need for a Client Event Pool, you can expose all the appropriate properties on the child controls which then can be set appropriately within it&#39;s parent, but think of it a step further, if you wanted a link on the Forgot Password to the Registration page. Because they aren&#39;t really aware of each other it is very difficult to achieve (but not impossible). Your UserControl can also expose wrappers to the Showing and Hiding client events on the modal popup, but it still has the same problem as mentioned previously.</p>
<p>And there we have it, a nice little example of how to use a Client Event Pool to make it easier to link previously unlinked components in a soft way.</p>
<p>The source code for this article can be found <a href="/get/web-dev/clienteventpooldemo.zip">here</a>.</p>
<h2>Framework agnostic</h2>
<p>So in the above demo I&#39;ve shown how to play around with it if you&#39;re using MS Ajax, but not every site we build will have MS Ajax as part of it.</p>
<p>I was recently doing a build where I wanted to use the event pool concept, but didn&#39;t want to use MS Ajax. So I set about simulating the concept in a framework agnostic way. </p>
<pre class="highlighted"><code class="matlab">EventManager = (<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
    var <span class="keyword">events</span> = <span class="cell">{}</span>;

    var getEvent = <span class="function"><span class="keyword">function</span> <span class="params">(id)</span> {</span>
        <span class="keyword">if</span> (!<span class="keyword">events</span><span class="matrix">[id]</span>) <span class="cell">{
            events[id] = [];
        }</span>
        <span class="keyword">return</span> <span class="keyword">events</span><span class="matrix">[id]</span>;
    };

    <span class="keyword">return</span> <span class="cell">{
        bind: function (name, fn) {
            var e = getEvent(name);
            e.push(fn);
        }</span>,
        trigger: <span class="function"><span class="keyword">function</span> <span class="params">(name, source, args)</span> {</span>
            var evt = getEvent(name);
            <span class="keyword">if</span> (!evt || (<span class="transposed_variable">evt.</span><span class="built_in">length</span> === <span class="number">0</span>)) <span class="keyword">return</span> null;
            evt = <span class="transposed_variable">evt.</span><span class="built_in">length</span> === <span class="number">1</span> ? <span class="matrix">[evt[<span class="number">0</span>]</span>] : <span class="transposed_variable">Array.</span>apply(null, evt);
            <span class="keyword">for</span> (var <span class="built_in">i</span> = <span class="number">0</span>, l = <span class="transposed_variable">evt.</span><span class="built_in">length</span>; <span class="built_in">i</span> &lt; l; <span class="built_in">i</span>++) <span class="cell">{
                if (args.constructor !== Array) args = [args];
                evt[i].apply(source, args);
            }</span>
        }
    };

})();</code></pre>
<p>This will create a global <code>EventManager</code> object (which sits at the window level) which has a <code>bind</code> and <code>trigger</code> event (which is the naming convention used by jQuery).</p>
<p>You <code>bind</code> to <code>EventManager</code> an event name you want to listen for, like so:</p>
<pre class="highlighted"><code class="matlab"><span class="transposed_variable">EventManager.</span>bind(<span class="string">'hideParent'</span>, <span class="keyword">function</span>(args) <span class="cell">{ /* do stuff */ }</span>);</code></pre>
<p>The <code>args</code> property is actually an array of all the arguments passed into the method by the <code>trigger</code> method, which is used like so:</p>
<pre class="highlighted"><code class="matlab"><span class="transposed_variable">EventManager.</span>trigger(<span class="string">'hideParent'</span>, this, <span class="cell">{ Hello: <span class="string">'World'</span> }</span>);</code></pre>
<p><code>args</code> can really be anything, from an object to an array, but I like to use single objects when passing around. You also need to pass in an object into the 2nd parameter which defines what will be used for the <code>this</code> scope of the event handlers which are triggered.</p>
<h2>Conclusion</h2>
<p>Hopefully this has been a bit of fun looking at how you can use MS Ajax or a generic implementation of a client event pool to have disconnected AJAX functionality.</p>

                        </article>
                    </div>
                    <div class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <div id="disqus_thread"></div>
<script>
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
window.disqus_shortname = 'aaronpowell'; // required: replace example with your forum shortname
window.disqus_identifier = document.title || 'Home';
window.disqus_developer = !! ~document.location.href.indexOf("localhost") ? 1 : 0;
window.disqus_url = document.location.origin + '/client-event-pool';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by</a>
<span class="logo-disqus"> Disqus</span>

                        </article>
                    </div>
                </div>
            </div>
        </div>

        <div id="footer-wrapper">

    <!-- Copyright -->
        <div id="copyright" class="container">
            <ul class="links">
                <li>&copy; Aaron Powell. All rights reserved</li>
                <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
            </ul>
        </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6399564-1']);
  _gaq.push(['_trackPageview']);

  (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script>

    </body>
</html>