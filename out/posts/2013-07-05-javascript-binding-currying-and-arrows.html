<!DOCTYPE HTML>
<!--
    Strongly Typed 1.0 by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
  <meta charset="utf-8">
  <title>JavaScript bind, currying and arrow functions - LINQ to Fail</title>
  <meta name="author" content="Aaron Powell">
  <meta name="viewport" content="width=1040" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Arvo:700" rel="stylesheet" type="text/css" />
  <link href="/css/highlightjs/solarized_light.css" rel="stylesheet" type="text/css" />
  <script src="/js/jquery-1.9.1.min.js"></script>
  <script src="/js/jquery.dropotron-1.3.js"></script>
  <script src="/js/config.js"></script>
  <script src="/js/skel.min.js"></script>
  <script src="/js/skel-ui.min.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/skel-noscript.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/style-desktop.css" />
  </noscript>
  <!--[if lte IE 8]><script src="/js/html5shiv.js"></script><![endif]-->

</head>

    <body class="left-sidebar">

        <div id="header-wrapper">
            <div id="header" class="container">
                <h1 id="logo">JavaScript bind, currying and arrow functions</h1>
                <h2>5th July 2013</h2>
                <ul class="tags">
    
        <li><a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a></li>
    
</ul>
                <!-- Nav -->
<nav id="nav">
    <ul>
        <li><a class="icon icon-home" href="/"><span>Home</span></a></li>
        <li><a class="icon icon-github" href="https://github.com/aaronpowell"><span>aaronpowell</span></a></li>
        <li><a class="icon icon-twitter" href="http://twitter.com/slace"><span>@slace</span></a></li>
        <li><a class="icon icon-book" href="/about"><span>About Me</span></a></li>
        <li><a class="icon icon-rss" href="/feed"><span>Feed</span></a></li>
    </ul>
</nav>

            </div>
        </div>

        <div id="main-wrapper">
            <div id="main" class="container">
                <div class="row">
                    <div id="sidebar" class="4u">
    <section>
        <ul class="divided">
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">10th July 2013</span>
                            <h3><a href="/posts/2013-07-10-implementing-indexers-in-javascript.html">Implementing "indexers" in JavaScript</a></h3>
                        </header>
                        <p>My colleague Luke Drumm challenged me to implement C# style indexers in JavaScript.</p>
<p>So let&#39;s have a look at how you can do that, and how you can make some very interesting JavaScript objects that are self replicating. We&#39;ll build on the knowledge of using <code>bind</code> and <code>apply</code> from the last two posts.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">4th July 2013</span>
                            <h3><a href="/posts/2013-07-04-javascript-call-and-apply.html">JavaScript call and apply</a></h3>
                        </header>
                        <p>After having confused one of my colleagues with some code that used the JavaScript <code>apply</code> method and giving them an answer that didn&#39;t leave them completely bemused I thought I&#39;d share my explanation with the world.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">21st June 2013</span>
                            <h3><a href="/posts/2013-06-21-walking-a-javascript-object.html">Walking a JavaScript object</a></h3>
                        </header>
                        <p>Ever had a path to a path to a property on a JavaScript object that you want to walk? Something along the lines of <code>foo.bar.baz</code>.</p>
<p>Recently I was trying to solve this problem and came across a nifty little trick</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">22nd January 2013</span>
                            <h3><a href="/posts/2013-01-22-hello-mathy.html">Hello mathy</a></h3>
                        </header>
                        <p>An introduction to another new library from me, this time it&#39;s mathy, a simple formula parser</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/typescript.html"><span>typescript</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/web.html"><span>web</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">14th January 2013</span>
                            <h3><a href="/posts/2013-01-14-ie10-console-thoughts.html">Making the Internet Explorer JavaScript tools better, again</a></h3>
                        </header>
                        <p>A look at what&#39;s changed since I last pointed out the failings of the IE dev tools</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/web.html"><span>web</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/internet-explorer.html"><span>internet-explorer</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/web-dev.html"><span>web-dev</span></a>
                            
                        </div>
                    </article>
                </li>
            
        </ul>
    </section>
</div>

                    <div id="content" class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <p>How many times have you written code like this:</p>
<pre class="highlighted"><code class="actionscript"><span class="keyword">var</span> foo = {
    makeRequest: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        $.<span class="keyword">get</span>(<span class="string">'/foo'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(result)</span> {</span>
                <span class="keyword">this</span>.update(result);
            });
        );
    },
    update: <span class="function"><span class="keyword">function</span> <span class="params">(data)</span> {</span> <span class="comment">/* ... */</span> }
};
<span class="comment">//somewhere later in the code</span>
foo.makeRequest();</code></pre>
<p>Only to have it poo itself saying that <code>this.update</code> is not a function? Maybe it was with an event handler not an AJAX request, all in all it&#39;s the same problem, you tried to use something and JavaScript changed the value of this on you.</p>
<p>Welcome to the wonderful world of JavaScript scoping.</p>
<p>So there&#39;s a bunch of ways which you can solve this, you can write the <code>var that = this;</code> style code being a very popular one, basically leveraging closure scopes to keep an instance of the type in memory until the function itself is GC&#39;ed.</p>
<p>But there&#39;s another approach, <code>Function.bind</code>.</p>
<p>We&#39;ll start with our simple demo:</p>
<pre class="highlighted"><code class="javascript"><span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span> <span class="params">(x)</span> {</span>
      console.log(<span class="keyword">this</span>, x, arguments);
};</code></pre>
<p>As we remember from last time we can get this:</p>
<pre class="highlighted"><code class="cs">foo(<span class="number">42</span>); <span class="comment">//console.log(window, 42, [42]);</span></code></pre>
<p>Now saw we can the foo function to have a known value of what this is when it&#39;s called, no matter how it&#39;s invoked, even if someone was to sneaky and use call or apply? Well that&#39;s what we can use the bind method for:</p>
<pre class="highlighted"><code class="haskell"><span class="title">var</span> bar = foo.bind({ a:<span class="string"> 'b'</span> });
<span class="title">bar</span>(<span class="number">42</span>); //console.log({ a:<span class="string"> 'b'</span> }, <span class="number">42</span>, [<span class="number">42</span>]);
<span class="title">bar</span>.call('abc', <span class="number">42</span>);</code></pre>
<p>So both times we call the bar function we have the same result, even though we&#39;re trying to specify a this context using the call method.</p>
<h2>Other uses for bind</h2>
<p>While bind is most commonly used to force a function to always have a specific value for the this object it can also be used for another purpose, to bind specific arguments. If we revisit our foo method we could do this:</p>
<pre class="highlighted"><code class="avrasm">var baz = foo<span class="preprocessor">.bind</span>(<span class="string">'a'</span>, <span class="string">'b'</span>)<span class="comment">;</span>
baz()<span class="comment">; //console.log('a', 'b', ['b']);</span></code></pre>
<h2>Practical application of argument binding</h2>
<p>When you&#39;re looking for a practical application for argument binding an idea that comes to mind is <a href="http://en.wikipedia.org/wiki/Currying">Currying</a>. I&#39;m not going to dive too deeply into what currying is, if you&#39;re not familiar with the concept start with the Wikipedia link and expand from there (also functional programming isn&#39;t my area of expertise, I just understand some of the basics and may be missing the point from here on out, if so Twitter is --&gt; for you to rant on).</p>
<p>Let&#39;s create a new function to add two numbers:</p>
<pre class="highlighted"><code class="javascript"><span class="keyword">var</span> sum = <span class="function"><span class="keyword">function</span> <span class="params">(x, y)</span> {</span>
      <span class="keyword">return</span> x + y;
};</code></pre>
<p>Ideally we want to be able to do something like this:</p>
<pre class="highlighted"><code class="cs"><span class="keyword">var</span> add2 = curry(sum, <span class="number">2</span>);
add2(<span class="number">4</span>); <span class="comment">// 6</span></code></pre>
<p>Now we&#39;ll create a curry function:</p>
<pre class="highlighted"><code class="matlab">var curry = <span class="function"><span class="keyword">function</span> <span class="params">(fn)</span> {</span>
      var args = <span class="transposed_variable">Array.</span><span class="transposed_variable">prototype.</span><span class="transposed_variable">slice.</span>call(arguments, <span class="number">1</span>);
      <span class="keyword">return</span> <span class="transposed_variable">fn.</span><span class="transposed_variable">bind.</span>apply(fn, <span class="matrix">[this].</span>concat(args);
};</code></pre>
<p>While this function is kind of trippy looking it&#39;s more because it&#39;s a very generic method, it&#39;s allowing us to curry a function and bind any number of arguments in place (which is why we&#39;re using the apply method of bind to provide an array of arguments) and the arguments we provide when calling the bound function will be appended on to the ones which we pre-bound.</p>
<p>But from this we end up with a new function that we can call as above.</p>
<p><em>Bonus: My colleague <a href="https://twitter.com/liammclennan">Liam Mclennan</a> flicked me <a href="https://gist.github.com/liammclennan/3654718#comment-559457">this gist</a> of how to do an even cooler currying approach.</em></p>
<h2>Fat arrows</h2>
<p>If you&#39;ve done anything with CoffeeScript or TypeScript you might be familiar with the concept of fat arrow functions. These languages use a modified syntax to deal with lexical scoping problem that bind can be used to solve. TypeScript tracks your usage of this in fat arrow functions and replaces it with a captured variable, CoffeeScript relies on the <code>@</code> symbol to do a similar thing.</p>
<p>For anyone who&#39;s not been following the evolution of <a href="http://wiki.ecmascript.org/doku.php?id=harmony:proposals">ECMAScript 6</a> (the next version of JavaScript) one of the accepted new syntax features is <a href="http://wiki.ecmascript.org/doku.php?id=harmony:arrow_function_syntax">arrow function syntax</a>.</p>
<p>Simply put the language is going to have a way to defining a function which you can be confident of what the this value will be (sure you can still futz with it if you want to but it&#39;s covering the most common scenarios).</p>
<p>To test out the new arrow function syntax grab Firefox v22 or newer.</p>

                        </article>
                    </div>
                    <div class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <div id="disqus_thread"></div>
<script>
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
window.disqus_shortname = 'aaronpowell'; // required: replace example with your forum shortname
window.disqus_identifier = document.title || 'Home';
window.disqus_developer = !! ~document.location.href.indexOf("localhost") ? 1 : 0;
window.disqus_url = document.location.origin + '/posts/2013-07-05-javascript-binding-currying-and-arrows.html';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by</a>
<span class="logo-disqus"> Disqus</span>

                        </article>
                    </div>
                </div>
            </div>
        </div>

        <div id="footer-wrapper">

    <!-- Copyright -->
        <div id="copyright" class="container">
            <ul class="links">
                <li>&copy; Aaron Powell. All rights reserved</li>
                <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
            </ul>
        </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6399564-1']);
  _gaq.push(['_trackPageview']);

  (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script>

    </body>
</html>