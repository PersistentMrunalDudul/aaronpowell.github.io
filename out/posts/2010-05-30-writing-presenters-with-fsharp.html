<!DOCTYPE HTML>
<!--
    Strongly Typed 1.0 by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
  <meta charset="utf-8">
  <title>Writing Presenters with F# | LINQ to Fail</title>
  <meta name="author" content="Aaron Powell">
  <meta name="viewport" content="width=1040" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Arvo:700" rel="stylesheet" type="text/css" />
  <link href="/css/highlightjs/solarized_light.css" rel="stylesheet" type="text/css" />
  <script src="/js/jquery-1.9.1.min.js"></script>
  <script src="/js/jquery.dropotron-1.3.js"></script>
  <script src="/js/config.js"></script>
  <script src="/js/skel.min.js"></script>
  <script src="/js/skel-ui.min.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/skel-noscript.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/style-desktop.css" />
  </noscript>
  <!--[if lte IE 8]><script src="/js/html5shiv.js"></script><![endif]-->

</head>

    <body class="left-sidebar">

        <div id="header-wrapper">
            <div id="header" class="container">
                <h1 id="logo">Writing Presenters with F#</h1>
                <h2>30th May 2010</h2>
                <ul class="tags">
    
        <li><a class="icon icon-tag" href="/tagged/webformsmvp.html"><span>webformsmvp</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/f-.html"><span>f#</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/fsharp.html"><span>fsharp</span></a></li>
    
</ul>
                <!-- Nav -->
<nav id="nav">
    <ul>
        <li><a class="icon icon-home" href="/"><span>Home</span></a></li>
        <li><a class="icon icon-github" href="https://github.com/aaronpowell"><span>aaronpowell</span></a></li>
        <li><a class="icon icon-twitter" href="http://twitter.com/slace"><span>@slace</span></a></li>
        <li><a class="icon icon-book" href="/about"><span>About Me</span></a></li>
        <li><a class="icon icon-rss" href="/feed"><span>Feed</span></a></li>
    </ul>
</nav>

            </div>
        </div>

        <div id="main-wrapper">
            <div id="main" class="container">
                <div class="row">
                    <div id="sidebar" class="4u">
    <section>
        <ul class="divided">
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">29th June 2010</span>
                            <h3><a href="/posts/2010-06-29-unit-testing-with-umbraco.html">Unit Testing with Umbraco</a></h3>
                        </header>
                        <p>A wrap up from my talk on doing unit tested ASP.NET with Umbraco</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/umbraco.html"><span>umbraco</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/asp-net.html"><span>asp.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/unit-testing.html"><span>unit-testing</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/webformsmvp.html"><span>webformsmvp</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">16th June 2010</span>
                            <h3><a href="/posts/2010-06-16-location-service-with-fsharp-and-twitter.html">Creating a location service with F# and Twitter</a></h3>
                        </header>
                        <p>Using Twitter to stalk someone has never been so easy!</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/f-.html"><span>f#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/twitter.html"><span>twitter</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/geo-location.html"><span>geo-location</span></a>
                            
                        </div>
                    </article>
                </li>
            
        </ul>
    </section>
</div>

                    <div id="content" class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <p><em>Disclaimer: I&#39;m not an F# developer, I&#39;m really only just learning and having a bit of a play around.</em></p>
<h1>What</h1>
<p>After a few beers the other day I had a great idea, why not write a demo of using WebForms MVP and F#. Sure, seems fun, seems crazy, seems like a silly idea! :P</p>
<p>But there was method in my (alcohol induced) madness, looking in F# as an option for development isn&#39;t a bad idea. F# as a functional languages offers some advantages which can&#39;t be achieved with a static language like C# or VB.NET, and since it does have some OO principles we can define types, use inheritance, all the stuff we can do with the other languages, so why can&#39;t we use it in a web scope?</p>
<p>I&#39;m not the first people who&#39;s tried using <a href="http://tomasp.net/articles/aspnet-fsharp-intro.aspx">F# with ASP.NET</a>, it&#39;s more about applying it in a different manner, in the scope of the WebForms MVP.</p>
<p>Hey, if this really works why couldn&#39;t you work with F# and Umbraco ;).</p>
<h1>Getting Started</h1>
<p>First step is the need to create a F# Class library (I&#39;m going to separate my UI into a standard C# web project for this):</p>
<p><img src="/get/web-dev/fsharp-01.PNG" alt="New Project"></p>
<p>So for this I&#39;m going to create a very simple little <code>Hello World</code> demo, so for this I&#39;m going to require 2 classes, I need a Presenter and a Model. Clear out the default files and next I make one called <code>HelloWorldPresenter</code>, it&#39;s just a standard F# Script file. Then I create a separate one called <code>HelloWorldModel</code>.</p>
<p>Keep in mind that the order of types does matter in F#, so since (as I&#39;ve stated) the Model file is created 2nd it&#39;ll appear in the project 2nd. You&#39;ll need to move it up to above the other file so that the type does get created by the time we actually need it.</p>
<p>Let&#39;s define our types:</p>
<pre class="highlighted"><code class="python">namespace WebFormsMvp.FSharp.Views.Models

type HelloWorldModel = <span class="class"><span class="keyword">class</span>
    <span class="title">val</span> <span class="title">mutable</span> <span class="title">private</span> <span class="title">msg</span> :</span> string

    new() = {
        msg = <span class="string">""</span>
    }

    member self.Message
        <span class="keyword">with</span> get() = self.msg
        <span class="keyword">and</span> set (value) = self.msg &lt;- value
end</code></pre>
<p>So here I&#39;m just defining a simple class with a string property which can be modified (hence the <code>mutable</code> keyword). It&#39;s a very basic Model, it&#39;s not really complex but it&#39;ll give you the idea of what can be done.</p>
<p>Next let&#39;s make a Presenter:</p>
<pre class="highlighted"><code class="vala"><span class="class"><span class="keyword">namespace</span> <span class="title">WebFormsMvp</span>.<span class="title">FSharp</span>.<span class="title">Presenters</span>

<span class="title">open</span> <span class="title">WebFormsMvp</span>
<span class="title">open</span> <span class="title">WebFormsMvp</span>.<span class="title">FSharp</span>.<span class="title">Views</span>.<span class="title">Models</span>
<span class="title">open</span> <span class="title">WebFormsMvp</span>.<span class="title">FSharp</span>.<span class="title">Wrapper</span>

<span class="title">type</span> <span class="title">HelloWorldPresenter</span> = <span class="title">class</span>
    <span class="title">inherit</span> <span class="title">PresenterBase</span>&lt;<span class="title">IView</span>&lt;<span class="title">HelloWorldModel</span>&gt;&gt;

    <span class="title">new</span> (<span class="title">view</span>) <span class="title">as</span> <span class="title">self</span> = {</span>
        inherit PresenterBase&lt;IView&lt;HelloWorldModel&gt;&gt;(view)
    }

    <span class="keyword">override</span> self.OnLoad(sender, e) = 
        self.View.Model.Message &lt;- <span class="string">"Hello World!"</span>

    <span class="keyword">override</span> self.ReleaseView() = ()    
end</code></pre>
<p>First we need to import and few namespaces, we need the WebFormsMvp namespace, the namespace for my Model class, and I&#39;ve also imported the namespace of a base class which I&#39;ve made to help. For some reason (most likely my lack of knowledge around F#) I was getting a compile error when creating the event handler, you should be able to do this in the constructor:</p>
<pre class="highlighted"><code class="objectivec"><span class="keyword">self</span><span class="variable">.View</span><span class="variable">.Load</span><span class="variable">.Add</span>(fun (sender:obj) (args:EventArgs) -&gt; <span class="keyword">self</span><span class="variable">.View</span><span class="variable">.Model</span><span class="variable">.Message</span> &lt;- <span class="string">"Hello World!"</span>)</code></pre>
<p>But as I said, that was creating a compile error so I created a base class (in C#) which assigned the event handler for me which I can then override.</p>
<p>That aside we can use the base class method to write to the Model.Message property, which ultimately, is what we want to do.</p>
<p>All that&#39;s left is that we need to create a C# Web Application Project and start the final implementation. Let&#39;s see how that looks:</p>
<pre class="highlighted"><code class="vala"><span class="keyword">using</span> WebFormsMvp;
<span class="keyword">using</span> WebFormsMvp.FSharp.Presenters;
<span class="keyword">using</span> WebFormsMvp.FSharp.Views.Models;
<span class="keyword">using</span> WebFormsMvp.Web;

<span class="class"><span class="keyword">namespace</span> <span class="title">WebformsMvp</span>.<span class="title">FShap</span>.<span class="title">Web</span>.<span class="title">UserControls</span>
{</span>
    [PresenterBinding(typeof(HelloWorldPresenter))]
    <span class="keyword">public</span> partial <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> : <span class="title">MvpUserControl</span>&lt;<span class="title">HelloWorldModel</span>&gt;, <span class="title">IView</span>&lt;<span class="title">HelloWorldModel</span>&gt;
    {</span>
    }
}</code></pre>
<p>It looks exactly like the <code>HelloWorldPresenter</code> came from any other language class library!</p>
<p><img src="/get/web-dev/fsharp-02.PNG" alt="It works!"></p>
<p>It just works like you&#39;d expect it to.</p>
<h2>Now What?</h2>
<p>Well this was really just a thought experiment, looking at how we could be a bit unconventional in your development approach. Whether or not this is viable in a real-world scenario is a matter of perspective. Currently for me it&#39;s not viable, but that&#39;s really because I don&#39;t have much in the way of F# skills.</p>
<p>If you were an F# developer this is an easy way to go about integrating F# into an ASP.NET Web Forms application, and in a unit-testable manner.</p>

                        </article>
                    </div>
                    <div class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <div id="disqus_thread"></div>
<script>
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
window.disqus_shortname = 'aaronpowell'; // required: replace example with your forum shortname
window.disqus_identifier = document.title || 'Home';
window.disqus_developer = !! ~document.location.href.indexOf("localhost") ? 1 : 0;
window.disqus_url = document.location.origin + '/writing-presenters-with-fsharp';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by</a>
<span class="logo-disqus"> Disqus</span>

                        </article>
                    </div>
                </div>
            </div>
        </div>

        <div id="footer-wrapper">

    <!-- Copyright -->
        <div id="copyright" class="container">
            <ul class="links">
                <li>&copy; Aaron Powell. All rights reserved</li>
                <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
            </ul>
        </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6399564-1']);
  _gaq.push(['_trackPageview']);

  (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script>

    </body>
</html>