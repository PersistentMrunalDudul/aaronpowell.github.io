<!DOCTYPE HTML>
<!--
    Strongly Typed 1.0 by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
  <meta charset="utf-8">
  <title>Array-like objects - LINQ to Fail</title>
  <meta name="author" content="Aaron Powell">
  <meta name="viewport" content="width=1040" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Arvo:700" rel="stylesheet" type="text/css" />
  <link href="/css/highlightjs/solarized_light.css" rel="stylesheet" type="text/css" />
  <script src="/js/jquery-1.9.1.min.js"></script>
  <script src="/js/jquery.dropotron-1.3.js"></script>
  <script src="/js/config.js"></script>
  <script src="/js/skel.min.js"></script>
  <script src="/js/skel-ui.min.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/skel-noscript.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/style-desktop.css" />
  </noscript>
  <!--[if lte IE 8]><script src="/js/html5shiv.js"></script><![endif]-->

</head>

    <body class="left-sidebar">

        <div id="header-wrapper">
            <div id="header" class="container">
                <h1 id="logo">Array-like objects</h1>
                <h2>22nd July 2013</h2>
                <ul class="tags">
    
        <li><a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a></li>
    
</ul>
                <!-- Nav -->
<nav id="nav">
    <ul>
        <li><a class="icon icon-home" href="/"><span>Home</span></a></li>
        <li><a class="icon icon-github" href="https://github.com/aaronpowell"><span>aaronpowell</span></a></li>
        <li><a class="icon icon-twitter" href="http://twitter.com/slace"><span>@slace</span></a></li>
        <li><a class="icon icon-book" href="/about"><span>About Me</span></a></li>
        <li><a class="icon icon-rss" href="/feed"><span>Feed</span></a></li>
    </ul>
</nav>

            </div>
        </div>

        <div id="main-wrapper">
            <div id="main" class="container">
                <div class="row">
                    <div id="sidebar" class="4u">
    <section>
        <ul class="divided">
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">14th July 2013</span>
                            <h3><a href="/posts/2013-07-14-javascript-new-operator.html">The JavaScript new operator</a></h3>
                        </header>
                        <p>Time to revisit something that was overlooked in the last post, the <code>new</code> operator in JavaScript and what it does.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">10th July 2013</span>
                            <h3><a href="/posts/2013-07-10-implementing-indexers-in-javascript.html">Implementing "indexers" in JavaScript</a></h3>
                        </header>
                        <p>My colleague Luke Drumm challenged me to implement C# style indexers in JavaScript.</p>
<p>So let&#39;s have a look at how you can do that, and how you can make some very interesting JavaScript objects that are self replicating. We&#39;ll build on the knowledge of using <code>bind</code> and <code>apply</code> from the last two posts.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">5th July 2013</span>
                            <h3><a href="/posts/2013-07-05-javascript-binding-currying-and-arrows.html">JavaScript bind, currying and arrow functions</a></h3>
                        </header>
                        <p>After confusing my colleagues with how to invoke functions with a modifided set of arguments at a single time the next evolutionary point was to confuse them with creating functions that are always called with a different state.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">4th July 2013</span>
                            <h3><a href="/posts/2013-07-04-javascript-call-and-apply.html">JavaScript call and apply</a></h3>
                        </header>
                        <p>After having confused one of my colleagues with some code that used the JavaScript <code>apply</code> method and giving them an answer that didn&#39;t leave them completely bemused I thought I&#39;d share my explanation with the world.</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">21st June 2013</span>
                            <h3><a href="/posts/2013-06-21-walking-a-javascript-object.html">Walking a JavaScript object</a></h3>
                        </header>
                        <p>Ever had a path to a path to a property on a JavaScript object that you want to walk? Something along the lines of <code>foo.bar.baz</code>.</p>
<p>Recently I was trying to solve this problem and came across a nifty little trick</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
        </ul>
    </section>
</div>

                    <div id="content" class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <p>You&#39;ve possibly head the saying</p>
<blockquote>
<p>When I see a bird that walks like a duck and swims like a duck and quacks like a duck, I call that bird a duck. - <a href="http://books.google.com/books?id=j7zds6xx7S0C&amp;pg=PA68&amp;dq=%22james+Riley%22+OR+%22James+Whitcomb+Riley%22+bird++duck&amp;num=100">credit</a></p>
</blockquote>
<p>This is a common adage when talking about <a href="http://en.wikipedia.org/wiki/Duck_typing">Duck Typing</a> in programming, especially when it comes to working with dynamic languages like JavaScript, based on assumptions made about an object you can attempt to infer other details. Statically typed languages on the other hand make it a bit harder to do Duck Typing, <a href="http://blogs.bartdesmet.net/blogs/bart/archive/2008/11/10/introducing-the-c-ducktaper-bridging-the-dynamic-world-with-the-static-world.aspx">that&#39;s not to say it&#39;s impossible</a>.</p>
<p>Due to the dynamic nature of JavaScript we actually come across this quite often with arrays in JavaScript. So what makes an object an array? Well there&#39;s two basic building blocks of an array:</p>
<ul>
<li>Numerical identifiers</li>
<li>A length property</li>
</ul>
<p>So take this code snippet:</p>
<pre class="highlighted"><code class="matlab">var foo = ??;
<span class="keyword">for</span> (var <span class="built_in">i</span> = <span class="number">0</span>; <span class="built_in">i</span> &lt; <span class="transposed_variable">foo.</span><span class="built_in">length</span>; <span class="built_in">i</span>++) <span class="cell">{
    console.log(foo[i]);
}</span></code></pre>
<p>From this we can infer that <code>foo</code> is quite possibly an array, it meets our basic requirements to be an array, but like the dangers of duck typing this doesn&#39;t mean that it&#39;s actually an array does it?</p>
<h1>Array-like objects</h1>
<p>It&#39;s quite common in JavaScript to come across array-like objects, objects that on the surface look like arrays but as soon as you look beneath the surface it&#39;ll become apparent that they aren&#39;t actually arrays. You&#39;ve probably come across these objects in the past and not really given it a second thought, two really common objects are the <code>arguments</code> object and a <code>NodeList</code> (you know, from <code>querySelectorAll</code>). Both of these objects have numerical indexers, length, but no <code>push</code>, <code>pop</code> and so on, basically they don&#39;t inherit <code>Array.prototype</code>.</p>
<p>With both of these objects the fact that they don&#39;t inherit from <code>Array.prototype</code> is a bit of a pain, it means you couldn&#39;t do something like this for example:</p>
<pre class="highlighted"><code class="matlab">var inputs = <span class="transposed_variable">form.</span>querySelectorAll(<span class="string">'input'</span>);
var values = <span class="transposed_variable">inputs.</span>map(<span class="function"><span class="keyword">function</span> <span class="params">(input)</span> {</span>
        <span class="keyword">return</span> <span class="cell">{
            value: input.value,
            name: input.getAttribute(<span class="string">'name'</span>)
        }</span>;
    });</code></pre>
<p>So this is a pretty simple bit of code, you want to get all the input name/value pairs, maybe to submit them via AJAX but that&#39;s not important, what&#39;s important is we&#39;re using the <code>Array.map</code> method, something very common if you&#39;re doing anything in a modern JavaScript engine (modern being &gt;= IE9).</p>
<h1>Making arrays of array-like objects</h1>
<p>If you&#39;ve found yourself an array-like object chances are you want to use it like an array, that begs the obvious question, how do we make it an array?</p>
<p>Well there&#39;s a pretty easy solution to this, we have numerical indexes and a length property, so what about a <code>for loop</code>:</p>
<pre class="highlighted"><code class="matlab">var items = <span class="matrix">[]</span>;
<span class="keyword">for</span> (var <span class="built_in">i</span> = <span class="number">0</span>, il = <span class="transposed_variable">inputs.</span><span class="built_in">length</span>; <span class="built_in">i</span> &lt; il; <span class="built_in">i</span>++) <span class="cell">{
    items.push(inputs[i]);
}</span></code></pre>
<p>But... <code>for loop</code>&#39;s are so old school there&#39;s got to be a better way. Well there is and here we can look at exploiting JavaScript&#39;s functions. We&#39;ve seen that you can use <a href="/posts/2013-07-04-javascript-call-and-apply.html"><code>call</code> and <code>apply</code></a> to futz with function scope and this we can do to improve our array-like object manipulation.</p>
<h1>Futzing slice</h1>
<p>When you&#39;re wanting to create new arrays from existing ones the easiest way is using the <code>slice</code> method. The <code>slice</code> method can be neat if you want to take parts of an array between two indexes, but it can also be used if you want to create a whole clone of the array, like so:</p>
<pre class="highlighted"><code class="avrasm">var array1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]<span class="comment">;</span>
var array2 = array1<span class="preprocessor">.slice</span>(<span class="number">0</span>)<span class="comment">;</span>
console<span class="preprocessor">.log</span>(array1 !== array2)<span class="comment">;</span></code></pre>
<p>By passing <code>0</code> we take a slice starting at index 0 and since we provided no end point it&#39;ll go to the length of the array.</p>
<p>But <code>slice</code> is a function just like everything else, you can use <code>call</code> against it.</p>
<p>And where it gets really interesting is when we play with our array-like objects, we can pass <em>that</em> as our context to our <code>slice</code> method:</p>
<pre class="highlighted"><code class="avrasm">var items = Array<span class="preprocessor">.prototype</span><span class="preprocessor">.slice</span><span class="preprocessor">.call</span>(inputs, <span class="number">0</span>)<span class="comment">;</span></code></pre>
<p>Yep that&#39;s right, <code>slice</code> doesn&#39;t require an array, just something that <em>looks</em> like an array, as far as <code>slice</code> is concerned it looks like a duck, it quacked, so hey, we&#39;ll treat it like a duck, check out <a href="http://hg.mozilla.org/mozilla-central/file/2268ff80683a/js/src/jsarray.cpp#l2536">the SpiderMonkey source</a>, it really only cares if there&#39;s a <code>length</code> property, pretty neat!</p>
<h1>Conclusion</h1>
<p>We&#39;ve seen some building blocks over the last few weeks, things we can use to manipulate functions and objects in the interesting ways and this is just another common usage of the patterns.</p>
<p>A small piece of advice, if you&#39;re doing a lot of these calls you can assign <code>slice</code> into a variable which you can use, which will make the minification work a whole lot better:</p>
<pre class="highlighted"><code class="avrasm">var slice = Array<span class="preprocessor">.prototype</span><span class="preprocessor">.slice</span><span class="comment">;</span>
var items = slice<span class="preprocessor">.call</span>(inputs, <span class="number">0</span>)<span class="comment">;</span></code></pre>

                        </article>
                    </div>
                    <div class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <div id="disqus_thread"></div>
<script>
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
window.disqus_shortname = 'aaronpowell'; // required: replace example with your forum shortname
window.disqus_identifier = document.title || 'Home';
window.disqus_developer = !! ~document.location.href.indexOf("localhost") ? 1 : 0;
window.disqus_url = document.location.origin + '/posts/2013-07-22-array-like-objects.html';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by</a>
<span class="logo-disqus"> Disqus</span>

                        </article>
                    </div>
                </div>
            </div>
        </div>

        <div id="footer-wrapper">

    <!-- Copyright -->
        <div id="copyright" class="container">
            <ul class="links">
                <li>&copy; Aaron Powell. All rights reserved</li>
                <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
            </ul>
        </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6399564-1']);
  _gaq.push(['_trackPageview']);

  (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script>

    </body>
</html>