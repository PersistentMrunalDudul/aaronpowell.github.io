<!DOCTYPE HTML>
<!--
    Strongly Typed 1.0 by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
  <meta charset="utf-8">
  <title>The settings suck - LINQ to Fail</title>
  <meta name="author" content="Aaron Powell">
  <meta name="viewport" content="width=1040" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Arvo:700" rel="stylesheet" type="text/css" />
  <link href="/css/highlightjs/solarized_light.css" rel="stylesheet" type="text/css" />
  <script src="/js/jquery-1.9.1.min.js"></script>
  <script src="/js/jquery.dropotron-1.3.js"></script>
  <script src="/js/config.js"></script>
  <script src="/js/skel.min.js"></script>
  <script src="/js/skel-ui.min.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/skel-noscript.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/style-desktop.css" />
  </noscript>
  <!--[if lte IE 8]><script src="/js/html5shiv.js"></script><![endif]-->

</head>

    <body class="left-sidebar">

        <div id="header-wrapper">
            <div id="header" class="container">
                <h1 id="logo">The settings suck</h1>
                <h2>14th September 2012</h2>
                <ul class="tags">
    
        <li><a class="icon icon-tag" href="/tagged/xaml.html"><span>xaml</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/windows8.html"><span>windows8</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/rant.html"><span>rant</span></a></li>
    
</ul>
                <!-- Nav -->
<nav id="nav">
    <ul>
        <li><a class="icon icon-home" href="/"><span>Home</span></a></li>
        <li><a class="icon icon-github" href="https://github.com/aaronpowell"><span>aaronpowell</span></a></li>
        <li><a class="icon icon-twitter" href="http://twitter.com/slace"><span>@slace</span></a></li>
        <li><a class="icon icon-book" href="/about"><span>About Me</span></a></li>
        <li><a class="icon icon-rss" href="/feed"><span>Feed</span></a></li>
    </ul>
</nav>

            </div>
        </div>

        <div id="main-wrapper">
            <div id="main" class="container">
                <div class="row">
                    <div id="sidebar" class="4u">
    <section>
        <ul class="divided">
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">8th January 2013</span>
                            <h3><a href="/posts/2013-01-08-the-problem-with-assert-istrue.html">The problem with Assert.IsTrue</a></h3>
                        </header>
                        <p>It&#39;s time for another rant, this time it&#39;s with how some people write their unit tests</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/unit-testing.html"><span>unit-testing</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/opinionated.html"><span>opinionated</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/ranting.html"><span>ranting</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/rant.html"><span>rant</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">24th September 2012</span>
                            <h3><a href="/posts/2012-09-24-check-if-file-exists.html">How to check if a file exists in Windows 8</a></h3>
                        </header>
                        <p>Ever wondered how to check if a file exists in Windows 8?</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/windows8.html"><span>windows8</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/winjs.html"><span>winjs</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/winrt.html"><span>winrt</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">14th September 2012</span>
                            <h3><a href="/posts/2012-09-14-creating-classes.html">Creating classes in WinJS</a></h3>
                        </header>
                        <p>A look at how you can create JavaScript classes in WinJS</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/winjs.html"><span>winjs</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/windows8.html"><span>windows8</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/javascript.html"><span>javascript</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">31st August 2012</span>
                            <h3><a href="/posts/2012-08-31-forcing-windows-8-keyboard-to-hide.html">Forcing Windows 8 soft keyboard to hide</a></h3>
                        </header>
                        <p>Hack of the day goes to how you hide the soft keyboard on a Windows 8 application</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/xaml.html"><span>xaml</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">28th August 2012</span>
                            <h3><a href="/posts/2012-08-28-webview-oh-you.html">WebView, oh you!</a></h3>
                        </header>
                        <p>Oh that WebView control is a funny one</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/xaml.html"><span>xaml</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/facepalm.html"><span>facepalm</span></a>
                            
                        </div>
                    </article>
                </li>
            
        </ul>
    </section>
</div>

                    <div id="content" class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <h1>Settings problems</h1>
<p>My first Windows 8 application I wrote using WinJS so a lot of my expectations on how settings worked in Windows 8 XAML was based off of that experience. Unfortunately from the looks of it the two teams had <em>very</em> different ideas on whether settings were important or not and thus we have drastically different experiences.</p>
<p>Here&#39;s the problems I&#39;ve hit so far:</p>
<ul>
<li>Setting up settings, if you do this &quot;too early&quot; (ie - before the app has fired off its Activated event) it crashes as the settings pane doesn&#39;t exist</li>
<li>There&#39;s no built-in settings control</li>
<li>Since there&#39;s no control there&#39;s no way to navigate to a particular settings pane</li>
<li>You use an event handler to register settings panes</li>
</ul>
<p>With the exception of the last point (which sucks in both platforms) these are problems specific to XAML based Windows 8 applications. What absolutely baffles me is that there&#39;s no settings stuff built into the platform, seriously, did no one think that that <strong>would be important</strong>? I mean it&#39;s not like you <a href="http://msdn.microsoft.com/en-us/library/windows/apps/hh694083.aspx#4.1.1_Your_app_must_have_a_privacy_statement_if_it_collects_personal_information">need to have a section in settings about privacy or anything</a>.</p>
<h1>Problem 1 - No built in control</h1>
<p>So let&#39;s start with the big one, the lack of built in control. It&#39;s reasonably trivial to roll you&#39;re own, as long as you take into account the following things:</p>
<ul>
<li>RTL vs LTR displays will open the settings on different sites, make sure you know which side the system settings are opening from and make your settings come from that site as well</li>
<li>You&#39;ll want it to animate in, check out the settings on the start screen, they have a nice little fly in so you&#39;ll want to replicate that yourself</li>
<li>You&#39;ll want a back button so your user can easily flick back to the overall settings pane</li>
<li>Make sure it&#39;s in the allowed widths, either 346 or 646 in width</li>
</ul>
<p>If you want to look into creating it there&#39;s a blog <a href="http://blog.jerrynixon.com/2012/08/how-to-create-windows-8-settings-pane.html">here</a> or <a href="http://code.msdn.microsoft.com/windowsapps/App-settings-sample-1f762f49">the official sample</a> that covers all the steps you&#39;ll be wanting to go through.</p>
<p>But realistically don&#39;t roll your own, check out the <a href="https://github.com/timheuer/callisto">Callisto</a>. It has a built in settings flyout that works very similar to the one in WinJS which is ace. Maybe the next version will just roll that into the platform.</p>
<h1>Problem 2 - Wiring up settings</h1>
<p>Say you want to have a global settings pane, maybe your privacy policy, well you&#39;re going to want to register this in the &quot;global&quot; part of the application. My initial instinct was to do this in the App.xaml.cs constructor. Seemed logical, it was something that I knew would only be executed once and well you&#39;re only registering an event handler through a static so that seemed good enough.</p>
<p>But no, no it&#39;s not. The problem is (and it&#39;s not clear to me from the documentation) that <a href="http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.applicationsettings.settingspane.getforcurrentview.aspx"><code>SettingsPane.GetForCurrentView()</code></a> if you don&#39;t have a view (ie - you&#39;re in the App constructor) then it will through a very unhelpful exception. Now sure, this may be <em>me</em> making a mistaken assumption on when you can register settings as in WinJS that&#39;s when you do it (well technically not in a constructor since there&#39;s no constructor really but you do it bright and early)!</p>
<h2>When to register</h2>
<p>So once you learn that you need to do it <em>later</em> the question is when? Well it turns out that this is where you need to be paying attention to the event model of Windows 8 applications, in particular the <code>Activated</code> event. This event is the first point that I&#39;ve been able to find you can register settings panes (or at least access the current view to setup the event handler).</p>
<p>Ideally you also want to check the <a href="http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.activation.activationkind"><code>ActivationKind</code></a> so you only register when your application first launches and not other times to avoid duplicate registration.</p>
<h2>Non-global settings</h2>
<p>Sometimes you might want settings which are not always there. Say you&#39;ve got some context-specific help that you want the users to be able to access, there&#39;d be no point having that available from every screen as it might introduce confusion about what the context is.</p>
<p>Well it turns out you can unregister settings panes by simply removing the event handler, so if you&#39;ve got this:</p>
<pre class="highlighted"><code class="objectivec">SettingsPane<span class="variable">.GetForCurrentView</span>()<span class="variable">.CommandRequested</span> += OnCommandRequested</code></pre>
<p>If you then remove that event handler:</p>
<pre class="highlighted"><code class="objectivec">SettingsPane<span class="variable">.GetForCurrentView</span>()<span class="variable">.CommandRequested</span> -= OnCommandRequested</code></pre>
<p>Any settings created there are automatically removed.</p>
<p>The ideal way to use this would be inside your <code>OnNavigatedTo</code> and <code>OnNavigatedFrom</code> methods (which come from the <code>Page</code> base class) you add/ remove the event handlers.</p>
<h1>Problem 3 - Navigation</h1>
<p>Since there&#39;s no built-in control and no real settings concept in the platform you can&#39;t &quot;go to&quot; a settings pane. Coming from WinJS I found <a href="http://msdn.microsoft.com/en-us/library/windows/apps/hh770581.aspx"><code>SettingsFlyout.showSettings</code></a> really quite useful, but since there&#39;s no comparative API in XAML you&#39;re pretty much stuffed.</p>
<p>So far the <em>best</em> answer I&#39;ve got from anyone on how to do this is to make your settings flyout (the one from Callisto) a &quot;global&quot; variable so you can change the <code>IsOpen</code> property of it to programmatically show it.</p>
<p>Now that just plain sucks.</p>
<h1>Conclusion</h1>
<p>Yes this was mostly a rant. As I keep saying the settings in Windows 8 XAML sucks. There&#39;s some very pointy edges, particularly when you are comparing the experience to the WinJS experience.</p>
<p>My tips are:</p>
<ul>
<li>Use Callisto, it&#39;s got a great control for doing settings (and many other good controls)</li>
<li>Know when and where you need to wire up your event handlers, ideally the Activated event but you can scope them to a particular page</li>
<li>Try to avoid a UX which requires the users to be forced into the settings, have it discoverable and intuitive for them</li>
</ul>

                        </article>
                    </div>
                    <div class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <div id="disqus_thread"></div>
<script>
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
window.disqus_shortname = 'aaronpowell'; // required: replace example with your forum shortname
window.disqus_identifier = document.title || 'Home';
window.disqus_developer = !! ~document.location.href.indexOf("localhost") ? 1 : 0;
window.disqus_url = document.location.origin + '/xaml/settings-suck';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by</a>
<span class="logo-disqus"> Disqus</span>

                        </article>
                    </div>
                </div>
            </div>
        </div>

        <div id="footer-wrapper">

    <!-- Copyright -->
        <div id="copyright" class="container">
            <ul class="links">
                <li>&copy; Aaron Powell. All rights reserved</li>
                <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
            </ul>
        </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6399564-1']);
  _gaq.push(['_trackPageview']);

  (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script>

    </body>
</html>