<!DOCTYPE HTML>
<!--
    Strongly Typed 1.0 by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
  <meta charset="utf-8">
  <title>Flight Mode - FileSystem API | LINQ to Fail</title>
  <meta name="author" content="Aaron Powell">
  <meta name="viewport" content="width=1040" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Arvo:700" rel="stylesheet" type="text/css" />
  <link href="/css/highlightjs/solarized_light.css" rel="stylesheet" type="text/css" />
  <script src="/js/jquery-1.9.1.min.js"></script>
  <script src="/js/jquery.dropotron-1.3.js"></script>
  <script src="/js/config.js"></script>
  <script src="/js/skel.min.js"></script>
  <script src="/js/skel-ui.min.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/skel-noscript.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/style-desktop.css" />
  </noscript>
  <!--[if lte IE 8]><script src="/js/html5shiv.js"></script><![endif]-->

</head>

    <body class="left-sidebar">

        <div id="header-wrapper">
            <div id="header" class="container">
                <h1 id="logo">Flight Mode - FileSystem API</h1>
                <h2>28th May 2013</h2>
                <ul class="tags">
    
        <li><a class="icon icon-tag" href="/tagged/flight-mode.html"><span>flight-mode</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/offline-storage.html"><span>offline-storage</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/file-system.html"><span>file-system</span></a></li>
    
</ul>
                <!-- Nav -->
<nav id="nav">
    <ul>
        <li><a class="icon icon-home" href="/"><span>Home</span></a></li>
        <li><a class="icon icon-github" href="https://github.com/aaronpowell"><span>aaronpowell</span></a></li>
        <li><a class="icon icon-twitter" href="http://twitter.com/slace"><span>@slace</span></a></li>
        <li><a class="icon icon-book" href="/about"><span>About Me</span></a></li>
        <li><a class="icon icon-rss" href="/feed"><span>Feed</span></a></li>
    </ul>
</nav>

            </div>
        </div>

        <div id="main-wrapper">
            <div id="main" class="container">
                <div class="row">
                    <div id="sidebar" class="4u">
    <section>
        <ul class="divided">
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">30th May 2013</span>
                            <h3><a href="/posts/2013-05-30-libraries.html">Flight Mode - Libraries</a></h3>
                        </header>
                        <p>Throughout the last few posts we&#39;ve looked at the different ways which we can store data offline in browsers and then created a basic little API that will help is with doing that. The <code>FlightMode</code> ...</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/flight-mode.html"><span>flight-mode</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/indexeddb.html"><span>indexeddb</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/localStorage.html"><span>localStorage</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/sessionStorage.html"><span>sessionStorage</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/offline-storage.html"><span>offline-storage</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">27th May 2013</span>
                            <h3><a href="/posts/2013-05-27-indexeddb.html">Flight Mode - IndexedDB</a></h3>
                        </header>
                        <p>The next stop in our offline storage adventure is to look at the big daddy of offline storage, <a href="http://www.w3.org/TR/IndexedDB/">IndexedDB</a>. Now I&#39;ve [blogged about <code>IndexedDB</code> in the past](http://...</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/flight-mode.html"><span>flight-mode</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/offline-storage.html"><span>offline-storage</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/indexeddb.html"><span>indexeddb</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">23rd May 2013</span>
                            <h3><a href="/posts/2013-05-23-introduction.html">Flight Mode - Introduction</a></h3>
                        </header>
                        <p>So you&#39;ve got an idea to build an amazing new web application, it&#39;s going to make you tens of dollars, hundreds of cents, it&#39;s all web API&#39;ed and SPA. There&#39;s a responsive design so it&#39;s mobile fri...</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/offline-storage.html"><span>offline-storage</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/flight-mode.html"><span>flight-mode</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">23rd May 2013</span>
                            <h3><a href="/posts/2013-05-23-local-session-storage.html">Flight Mode - local and session storage</a></h3>
                        </header>
                        <p>Last time we looked a <a href="/flight-mode/cookies">using cookies to store offline data</a> and we also saw that there&#39;s a number of problems with that approach. So let&#39;s move forward, let&#39;s look at what our...</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/flight-mode.html"><span>flight-mode</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/offline-storage.html"><span>offline-storage</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/localStorage.html"><span>localStorage</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/sessionStorage.html"><span>sessionStorage</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">23rd May 2013</span>
                            <h3><a href="/posts/2013-05-23-cookies.html">Flight Mode - Cookies</a></h3>
                        </header>
                        <p>In the beginning there was a simple way to store data offline in an application, or more accurately, across sessions, and that is the HTTP Cookie.</p>
<p>Cookies are used for everything, they can [track ...</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/offline-storage.html"><span>offline-storage</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/flight-mode.html"><span>flight-mode</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/cookies.html"><span>cookies</span></a>
                            
                        </div>
                    </article>
                </li>
            
        </ul>
    </section>
</div>

                    <div id="content" class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <p>The last piece of the puzzle when looking at offline storage options is a bit of a shift from what we&#39;ve been looking at so far. Generally speaking we&#39;ve been looking at how to store plain data, either through key/value stores or as objects. This time we&#39;re going to look at the other kind of data you might want to store, files.</p>
<p>There&#39;s two way we might want to store files, as binary data in IndexedDB or using the <a href="http://dev.w3.org/2009/dap/file-system/file-dir-sys.html">FileSystem API</a>. Since we looked at <a href="/flight-mode/indexeddb">IndexedDB last time</a> (although didn&#39;t cover how to store Blobs, but the principle is the same as we looked at) this time we&#39;ll look at the FileSystem API.</p>
<p><em>Side note: At the time of writing the only browser supporting this API is Chrome so this is more of a &quot;watch this space&quot; style post than a &quot;go use it now&quot; one.</em></p>
<p>The idea of the FileSystem API is to give browsers the ability to persist files either temporarily or permanent. Temporary persistence means that the browser is free to decide when it wants to get ride of the file system that has created where as permanent persistence means that it will not do an automatic cleanup of the files and folders.</p>
<p>Essentially what you end up with from the API is an ability to create files and folders in a sandboxed scenario. You don&#39;t have access to the real file system of the device, so no access to <code>My Documents</code> or <code>Program Files</code>, just an isolated little location to work in. So this can be really quite useful if you&#39;re say building a game, chances are you have a few assets that are required (audio, video, graphics) and the ability to retrieve them without web requests can be advantageous.</p>
<h2>Benefits of the FileSystem for storage</h2>
<p><em>As mentioned this API is serving a different purpose to the other storage APIs we&#39;ve looked at, with the exception of IndexedDB (in a limited scenario at least) so some of the benefits are unfair comparisions.</em></p>
<p>Like IndexedDB the FileSystem API is an asynchronous API which has the obvious benefits when it comes to working with the kind of data it is designed for, storing large files you do ideally want that to be done asynchronously so that you aren&#39;t blocking the users interactions.</p>
<p>Another benefit is that the file system you create is completely sandboxed, meaning you don&#39;t have to worry about what others may try and do to it. The only thing you need to take into account is the persistence level of the file system, as mentioned above temporary file systems are at the browsers mercy for clean-up, but it&#39;s an opt-in to be using temporary persistence.</p>
<p>As with other storage options there are size limitations on the file system that is created, the difference is (at least at the time of writing) you can specify the size of the file system you want. Chrome will then determine whether the user needs to approve this storage level and if so request permission like other device-sensitive APIs (<code>getUserMedia</code> for example).</p>
<p>The API itself is quite nice to work with, especially if you&#39;re coming from a server background, creating new files is handled through writer streams while you have separate streams for reading files. You can store files of different types with different encodings and have a lot of flexibility to create a directory structure that suites your needs.</p>
<h2>Drawbacks of the FileSystem for storage</h2>
<p>The main drawback is browser support, as mentioned Chrome is the only browser at present that implements the FileSystem API and it seems that one of their main drivers is use within their extension system. While there&#39;s nothing wrong with that it does mean that it&#39;s not really possible to utilize this API is a cross-browser scenario. There is a <a href="https://github.com/ebidel/idb.filesystem.js">shim available that uses IndexedDB</a> but it does require your IndexedDB implementation to support <code>Blob</code> storage which can be a problem in Internet Explorer 10.</p>
<p>Another drawback is the API interactions, while it&#39;s not quite as verbose as working with IndexedDB the API itself partially relies on the DOM Level 3 events and partially relies on callbacks being provided. This means that in some instances you&#39;ll be attaching event handlers, like when you&#39;re using a <code>FileReader</code>:</p>
<pre class="highlighted"><code class="r">var reader = new FileReader();
reader.onloadend = <span class="keyword">function</span> (e) { <span class="keyword">...</span> };
reader.readAsText(file);</code></pre>
<p>And other times you&#39;ll have to pass a callback:</p>
<pre class="highlighted"><code class="avrasm">window<span class="preprocessor">.requestFileSystem</span>(window<span class="preprocessor">.TEMPORARY</span>, <span class="number">1024</span>*<span class="number">1024</span>, onInit, onError)<span class="comment">;</span></code></pre>
<p>API inconsistence can be annoying for developers to work with and something that you need to be mindful of.</p>
<p>The final drawback I see is that there&#39;s no file system querying available, meaning you have to know where your files are stored, which can be a bit tricky when you&#39;re working with directories in your file system. Admittedly this is a minor problem, you probably shouldn&#39;t be storing files that you don&#39;t know the location of in the file system but it can still be something that you&#39;d want.</p>
<h2>Implementing FileSystem storage</h2>
<p>Unlike the other storage options I&#39;ve decided to <strong>not</strong> cover off how to implement this API because:</p>
<ol>
<li>It really wouldn&#39;t fit with the <code>FlightMode</code> API we&#39;ve got so far, that&#39;s designed for non-hierarchical data</li>
<li>This is more of a <em>watch this space</em> post than a <em>go use it</em> one since the browser support is quite lacking</li>
<li>There is a <a href="http://www.html5rocks.com/en/tutorials/file/filesystem/">great article on HTML5 Rocks</a> that&#39;ll do it more justice than I can give it</li>
</ol>
<h1>Conclusion</h1>
<p>The idea of being able to store files, complete files, in a structured manner on the client is a really exciting one. Admittedly there&#39;s a much narrower use-case for such an API compared to other storage options we&#39;ve discussed the problems that it solves are very real and will likely become more valid as more true web applications rise.</p>
<p>The API itself is not back to work against, if it is a bit inconsistent and keep in mind that the specification is still in draft status so it may change in the future.</p>

                        </article>
                    </div>
                    <div class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <div id="disqus_thread"></div>
<script>
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
window.disqus_shortname = 'aaronpowell'; // required: replace example with your forum shortname
window.disqus_identifier = document.title || 'Home';
window.disqus_developer = !! ~document.location.href.indexOf("localhost") ? 1 : 0;
window.disqus_url = document.location.origin + '/flight-mode/file-system';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by</a>
<span class="logo-disqus"> Disqus</span>

                        </article>
                    </div>
                </div>
            </div>
        </div>

        <div id="footer-wrapper">

    <!-- Copyright -->
        <div id="copyright" class="container">
            <ul class="links">
                <li>&copy; Aaron Powell. All rights reserved</li>
                <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
            </ul>
        </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6399564-1']);
  _gaq.push(['_trackPageview']);

  (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script>

    </body>
</html>