<!DOCTYPE HTML>
<!--
    Strongly Typed 1.0 by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
  <meta charset="utf-8">
  <title>Using Lazy&lt;T&gt; with KeyedCollection | LINQ to Fail</title>
  <meta name="author" content="Aaron Powell">
  <meta name="viewport" content="width=1040" />
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Arvo:700" rel="stylesheet" type="text/css" />
  <link href="/css/highlightjs/solarized_light.css" rel="stylesheet" type="text/css" />
  <script src="/js/jquery-1.9.1.min.js"></script>
  <script src="/js/jquery.dropotron-1.3.js"></script>
  <script src="/js/config.js"></script>
  <script src="/js/skel.min.js"></script>
  <script src="/js/skel-ui.min.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/skel-noscript.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/style-desktop.css" />
  </noscript>
  <!--[if lte IE 8]><script src="/js/html5shiv.js"></script><![endif]-->

</head>

    <body class="left-sidebar">

        <div id="header-wrapper">
            <div id="header" class="container">
                <h1 id="logo">Using Lazy<T> with KeyedCollection</h1>
                <h2>22nd September 2010</h2>
                <ul class="tags">
    
        <li><a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a></li>
    
        <li><a class="icon icon-tag" href="/tagged/collections.html"><span>collections</span></a></li>
    
</ul>
                <!-- Nav -->
<nav id="nav">
    <ul>
        <li><a class="icon icon-home" href="/"><span>Home</span></a></li>
        <li><a class="icon icon-github" href="https://github.com/aaronpowell"><span>aaronpowell</span></a></li>
        <li><a class="icon icon-twitter" href="http://twitter.com/slace"><span>@slace</span></a></li>
        <li><a class="icon icon-book" href="/about"><span>About Me</span></a></li>
        <li><a class="icon icon-rss" href="/feed"><span>Feed</span></a></li>
    </ul>
</nav>

            </div>
        </div>

        <div id="main-wrapper">
            <div id="main" class="container">
                <div class="row">
                    <div id="sidebar" class="4u">
    <section>
        <ul class="divided">
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">14th April 2010</span>
                            <h3><a href="/posts/2010-04-14-lucene-net-overview.html">An overview of Lucene.Net</a></h3>
                        </header>
                        <p>Overview and table-of-contents for Lucene.Net articles</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/lucene-net.html"><span>lucene.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/examine.html"><span>examine</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/umbraco-examine.html"><span>umbraco-examine</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">30th March 2011</span>
                            <h3><a href="/posts/2011-03-30-binding.html">Fun with Expression Trees and property binding</a></h3>
                        </header>
                        <p>The client I&#39;m currently working for is using an MVP pattern with WebForms (not [WebFormsMVP][1] but an internally developed one) which is using an active view pattern. What this means is that the ...</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-4.html"><span>c#-4</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/expression-tree-fun.html"><span>expression-tree-fun</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">5th July 2010</span>
                            <h3><a href="/posts/2010-07-05-dynamics-library.html">Dynamics Library</a></h3>
                        </header>
                        <p>A series of helper methods for working with the DLR in C# 4.0</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/dynamic.html"><span>dynamic</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">28th June 2010</span>
                            <h3><a href="/posts/2010-06-28-dynamic-dictionaries-with-csharp-4.html">Dynamic Dictionaries with C# 4.0</a></h3>
                        </header>
                        <p>Using the C# dynamic features to make it easier to work with Dictionary objects</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/dynamic.html"><span>dynamic</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/umbraco.html"><span>umbraco</span></a>
                            
                        </div>
                    </article>
                </li>
            
                <li>
                    <article class="is-excerpt">
                        <header>
                            <span class="date">27th May 2010</span>
                            <h3><a href="/posts/2010-05-27-lucene-analyzer.html">Analyzers in Lucene.Net</a></h3>
                        </header>
                        <h2>What is an Analyzer?</h2>
<p>When you want to insert data into a Lucene index, or when you want to get the data back out of the index you will need to use an Analyzer to do this.</p>
<p>Lucene ships with ma...</p>

                        <div class="tags">
                            
                                <a class="icon icon-tag" href="/tagged/lucene-net.html"><span>lucene.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/c-.html"><span>c#</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/net.html"><span>.net</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/examine.html"><span>examine</span></a>
                            
                                <a class="icon icon-tag" href="/tagged/umbraco-examine.html"><span>umbraco-examine</span></a>
                            
                        </div>
                    </article>
                </li>
            
        </ul>
    </section>
</div>

                    <div id="content" class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <p>For a project which I&#39;m currently working on I&#39;ve got a few custom collections which I need to return from various methods on a data repository. There&#39;s a bit of heavy lifting that is done in each of the repository methods so I wanted to have a way which each of them could be lazy loading the items into the collection. This would also mean that if you&#39;re only wanting a subset of the collection you don&#39;t create all the objects.</p>
<p>Since the collections are representing a data model I decided that I&#39;d go with the <a href="http://msdn.microsoft.com/en-us/library/ms132438.aspx">KeyedCollection</a>, as it&#39;s a well designed collection for what I need, similar to a List but had a key for each item. And since we&#39;re representing a data model having a key is important.</p>
<p>There&#39;s a handy class in the .NET 4.0 framework which I wanted to use, <a href="http://msdn.microsoft.com/en-us/library/dd642331.aspx">Lazy&lt;T&gt;</a> which is handy as it takes a lambda statement into the constructor so that I defer the object creation.</p>
<h2>Introducing KeyedCollection</h2>
<p>If you haven&#39;t worked with KeyedCollection before it&#39;s quite a handy class. It&#39;s an abstract class so you have to implement it when ever you want to use it. The reason for this is that you have to implement a method called <a href="http://msdn.microsoft.com/en-us/library/ms132454.aspx"><code>GetKeyForItem</code></a> which tells the collection how to resolve the key for each item. This is where KeyedCollection differs from the <a href="http://msdn.microsoft.com/en-us/library/xfhwa508.aspxBlockquote">Dictionary</a> class; for a Dictionary you need to pass in the key value each time.</p>
<p>I&#39;m sure you can see the advantage of the KeyedCollection now for what I&#39;m doing, it can reduce code smell quite nicely.</p>
<h2>Getting Lazy</h2>
<p>So let&#39;s get started with making a collection which is lazy and we&#39;ll have a look at something which tripped me up when implementing it.</p>
<p>For the purpose of this blog I&#39;ve got some stubbed out classes that could represent a data entity, one called <code>Id</code>:</p>
<pre class="highlighted"><code class="vala"><span class="class"><span class="keyword">class</span> <span class="title">Id</span>
{</span>
    <span class="keyword">public</span> <span class="keyword">string</span> Alias { <span class="keyword">get</span>; <span class="keyword">set</span>; }
    <span class="keyword">public</span> <span class="keyword">string</span> Name { <span class="keyword">get</span>; <span class="keyword">set</span>; }
}</code></pre>
<p>This will be the key in our collection, and an <code>Entity</code> class:</p>
<pre class="highlighted"><code class="actionscript"><span class="class"><span class="keyword">class</span> <span class="title">Entity</span>
{</span>
    <span class="keyword">public</span> Id Id { <span class="keyword">get</span>; <span class="keyword">set</span>; }
    <span class="keyword">public</span> DateTime CreatedDate { <span class="keyword">get</span>; <span class="keyword">set</span>; }
}</code></pre>
<p>We&#39;ll be creating an implementation of <code>KeyedCollection</code> and lets start with our basic class:</p>
<pre class="highlighted"><code class="actionscript"><span class="class"><span class="keyword">class</span> <span class="title">LazyKeyedCollection</span>&lt;<span class="title">T</span>&gt; : <span class="title">KeyedCollection</span>&lt;<span class="title">Id</span>, <span class="title">Lazy</span>&lt;<span class="title">T</span>&gt;&gt;
        <span class="title">where</span> <span class="title">T</span> : <span class="title">Entity</span>
{</span>
    <span class="keyword">protected</span> <span class="keyword">override</span> Id GetKeyForItem(Lazy&lt;T&gt; item)
    {
        <span class="keyword">throw</span> <span class="keyword">new</span> NotImplementedException();
    }
}</code></pre>
<p>In this implementation I&#39;ve made the collection a generic so that you can sub-class out the <code>Entity</code> object (which is likely if we were implementing this into a full-scale application, as I&#39;m doing). You&#39;ll notice that <code>KeyedCollection</code> actually is <code>KeyedCollection&lt;Id, Lazy&lt;T&gt;&gt;</code>, which is wrapping our generic argument into the <code>Lazy</code> object.</p>
<p>As I mentioned above we need to implement a method which tells it how we&#39;re going to get the key from the object (our <code>Entity</code>), so let&#39;s implement that:</p>
<pre class="highlighted"><code class="applescript">protected override Id GetKeyForItem(Lazy&lt;T&gt; <span class="property">item</span>)
{
    //access <span class="keyword">the</span> <span class="type">real</span> <span class="property">item</span> <span class="keyword">from</span> <span class="keyword">the</span> lazy object
<span class="command">    return</span> <span class="property">item</span>.Value.Id;
}</code></pre>
<p>So here&#39;s how the collection object will determine what is the key is for each item. But we&#39;re after something that&#39;s happening in a lazy fashion, so let&#39;s write a little application to use it and we&#39;ll make sure that it is lazy like we expect:</p>
<pre class="highlighted"><code class="avrasm">class Program
{
    static void Main(string[] args)
    {
        var range = Enumerable<span class="preprocessor">.Range</span>(<span class="number">0</span>, <span class="number">10</span>)<span class="comment">;</span>

        var lkc = new LazyKeyedCollection&lt;Entity&gt;()<span class="comment">;</span>
        foreach (var item <span class="keyword">in</span> range)
        {
            var i = item<span class="comment">;</span>
            Console<span class="preprocessor">.WriteLine</span>(<span class="string">"Adding item "</span> + i + <span class="string">" to LazyKeyedCollection"</span>)<span class="comment">;</span>
            lkc<span class="preprocessor">.Add</span>(new Lazy&lt;Entity&gt;(() =&gt;
            {
                var e = new Entity()<span class="comment">;</span>

                e<span class="preprocessor">.Id</span> = new Id
                {
                    Alias = i<span class="preprocessor">.ToString</span>(),
                    Name = <span class="string">"LazyKeyedCollection item "</span> + i
                }<span class="comment">;</span>
                e<span class="preprocessor">.CreatedDate</span> = DateTime<span class="preprocessor">.Now</span><span class="comment">;</span>

                Console<span class="preprocessor">.WriteLine</span>(<span class="string">"Created entity '"</span> + e<span class="preprocessor">.Id</span><span class="preprocessor">.Name</span> + <span class="string">"'"</span>)<span class="comment">;</span>
                return e<span class="comment">;</span>
            }))<span class="comment">;</span>
        }
    }
}</code></pre>
<blockquote>
<p>Adding item 0 to LazyKeyedCollection</p>
<p>Created entity &#39;LazyKeyedCollection item 0&#39;</p>
<p>Adding item 1 to LazyKeyedCollection</p>
<p>Created entity &#39;LazyKeyedCollection item 1&#39;</p>
<p>Adding item 2 to LazyKeyedCollection</p>
<p>Created entity &#39;LazyKeyedCollection item 2&#39;</p>
<p>Adding item 3 to LazyKeyedCollection</p>
<p>Created entity &#39;LazyKeyedCollection item 3&#39;</p>
<p>Adding item 4 to LazyKeyedCollection</p>
<p>Created entity &#39;LazyKeyedCollection item 4&#39;</p>
<p>Adding item 5 to LazyKeyedCollection</p>
<p>Created entity &#39;LazyKeyedCollection item 5&#39;</p>
<p>Adding item 6 to LazyKeyedCollection</p>
<p>Created entity &#39;LazyKeyedCollection item 6&#39;</p>
<p>Adding item 7 to LazyKeyedCollection</p>
<p>Created entity &#39;LazyKeyedCollection item 7&#39;</p>
<p>Adding item 8 to LazyKeyedCollection</p>
<p>Created entity &#39;LazyKeyedCollection item 8&#39;</p>
<p>Adding item 9 to LazyKeyedCollection</p>
<p>Created entity &#39;LazyKeyedCollection item 9&#39;</p>
</blockquote>
<p>Oh crap, look at that, we&#39;re evaluating the lambda expression way to early, in fact it&#39;s happening as soon as we add the item into the collection. That doesn&#39;t sound very lazy now does it?</p>
<p>So why did this happen? Well the problem is the <code>GetKeyForItem</code> method. Because we have to tell the collection how to find the key it has to <em>create the object</em> before it can resolve the key! Well shit, that&#39;s not good, we&#39;re completely missing the point of creating a lazy collection.</p>
<p>This is where I got tripped up in my implementation, so I needed to find another way around what I was doing...</p>
<h2>Getting Lazier</h2>
<p>We&#39;ve got a problem, we need to know the ID of the object, but we don&#39;t want to create the object. So how to do this... We&#39;ll do a different implementation of our lazy collection:</p>
<pre class="highlighted"><code class="actionscript"><span class="class"><span class="keyword">class</span> <span class="title">LazyKeyedCollectionMark2</span>&lt;<span class="title">T</span>&gt; : <span class="title">KeyedCollection</span>&lt;<span class="title">Id</span>, <span class="title">KeyValuePair</span>&lt;<span class="title">Id</span>, <span class="title">Lazy</span>&lt;<span class="title">T</span>&gt;&gt;&gt;
    <span class="title">where</span> <span class="title">T</span> : <span class="title">Entity</span>
{</span>
    <span class="keyword">protected</span> <span class="keyword">override</span> Id GetKeyForItem(KeyValuePair&lt;Id, Lazy&lt;T&gt;&gt; item)
    {
        <span class="keyword">throw</span> <span class="keyword">new</span> NotImplementedException();
    }
}</code></pre>
<p>There&#39;s a very subtle change in this implementation, now the <em>value</em> type argument of the <code>KeyedCollection</code> is no longer just <code>Lazy&lt;T&gt;</code> but instead it is <code>KeyValuePair&lt;Id, Lazy&lt;T&gt;&gt;</code> and this means that our implementation of <code>GetKeyForItem</code> is refactored to look like this:</p>
<pre class="highlighted"><code class="nginx"><span class="title">protected</span> override Id GetKeyForItem(KeyValuePair&lt;Id, Lazy&lt;T&gt;&gt; item)
{
    <span class="title">return</span> item.Key;
}</code></pre>
<p>Well now our <code>item</code> object already knows about the key without having to request it from our lazy object, so this should be nice and easy to work with, let&#39;s add test it to make sure that we&#39;re really lazy with this new code:</p>
<pre class="highlighted"><code class="erlang">var lkcm2 = new <span class="variable">LazyKeyedCollectionMark2</span>&lt;<span class="variable">Entity</span>&gt;();
<span class="function"><span class="title">foreach</span> <span class="params">(var item in range)</span>
{
    <span class="title">var</span> <span class="title">i</span> = <span class="title">item</span>;
    C<span class="title">onsole</span>.W<span class="title">riteLine</span><span class="params">(<span class="string">"Adding item "</span> + i + <span class="string">" to LazyKeyedCollectionMark2"</span>)</span>;
    I<span class="title">d</span> <span class="title">id</span> = <span class="title">new</span> I<span class="title">d</span>
    {
        A<span class="title">lias</span> = <span class="title">i</span>.T<span class="title">oString</span><span class="params">()</span>,
        N<span class="title">ame</span> = "L<span class="title">azyKeyedCollectionMark2</span> <span class="title">item</span> " + <span class="title">i</span>
    }; 

    <span class="title">lkcm2</span>.A<span class="title">dd</span><span class="params">(new <span class="variable">KeyValuePair</span>&lt;<span class="variable">Id</span>, <span class="variable">Lazy</span>&lt;<span class="variable">Entity</span>&gt;&gt;(id, new <span class="variable">Lazy</span>&lt;<span class="variable">Entity</span>&gt;(()</span> =&gt;
    {
        <span class="title">var</span> <span class="title">e</span> = <span class="title">new</span> E<span class="title">ntity</span><span class="params">()</span>;

        <span class="title">e</span>.I<span class="title">d</span> = <span class="title">id</span>;
        <span class="title">e</span>.C<span class="title">reatedDate</span> = D<span class="title">ateTime</span>.N<span class="title">ow</span>;

        C<span class="title">onsole</span>.W<span class="title">riteLine</span><span class="params">(<span class="string">"Created entity '"</span> + e.<span class="variable">Id</span>.<span class="variable">Name</span> + <span class="string">"'"</span>)</span>;
        <span class="title">return</span> <span class="title">e</span>;
    })));
}</code></pre>
<p>And what does it output:</p>
<blockquote>
<p>Adding item 0 to LazyKeyedCollectionMark2</p>
<p>Adding item 1 to LazyKeyedCollectionMark2</p>
<p>Adding item 2 to LazyKeyedCollectionMark2</p>
<p>Adding item 3 to LazyKeyedCollectionMark2</p>
<p>Adding item 4 to LazyKeyedCollectionMark2</p>
<p>Adding item 5 to LazyKeyedCollectionMark2</p>
<p>Adding item 6 to LazyKeyedCollectionMark2</p>
<p>Adding item 7 to LazyKeyedCollectionMark2</p>
<p>Adding item 8 to LazyKeyedCollectionMark2</p>
<p>Adding item 9 to LazyKeyedCollectionMark2</p>
</blockquote>
<p>Fantastic! We&#39;re not creating the object when we&#39;re adding it to the collection, and that&#39;s what we wanted to see. Now let&#39;s test iterating through the collection, and just output the <code>CreatedDate</code> property:</p>
<pre class="highlighted"><code class="avrasm">foreach (var item <span class="keyword">in</span> lkcm2)
{
    Console<span class="preprocessor">.WriteLine</span>(item<span class="preprocessor">.Value</span><span class="preprocessor">.Value</span><span class="preprocessor">.CreatedDate</span><span class="preprocessor">.ToString</span>(<span class="string">"hh:mm:ss.ffffzzz"</span>))<span class="comment">;</span>
}</code></pre>
<p>Eww, that&#39;s ugly, cuz we&#39;re getting back a <code>KeyValuePair</code> object we have to grab out the through the <code>Value</code> property, and then cuz we&#39;ve still got our <code>Lazy&lt;T&gt;</code> object we have access its <code>Value</code> property. This has really added some code-smell back in so let&#39;s see if we can clean it up a bit. We&#39;ll override the <code>GetEnumerator</code> of our collection:</p>
<pre class="highlighted"><code class="cs"><span class="keyword">public</span> <span class="keyword">new</span> IEnumerator&lt;T&gt; GetEnumerator()
{
    <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> <span class="keyword">this</span>.Dictionary.Values)
        <span class="keyword">yield</span> <span class="keyword">return</span> item.Value.Value;
}</code></pre>
<p>Now we&#39;ll be getting back the actual instance of <code>T</code> rather than our double-wrapped version of it. Now our foreach looks like this:</p>
<pre class="highlighted"><code class="erlang"><span class="function"><span class="title">foreach</span> <span class="params">(var item in lkcm2)</span>
{
    C<span class="title">onsole</span>.W<span class="title">riteLine</span><span class="params">(item.<span class="variable">CreatedDate</span>.<span class="variable">ToString</span>(<span class="string">"hh:mm:ss.ffffzzz"</span>)</span>);
}</code></pre>
<p>And the result looks like this:</p>
<blockquote>
<p>Created entity &#39;LazyKeyedCollectionMark2 item 0&#39;</p>
<p>09:23:59.1277+10:00</p>
<p>Created entity &#39;LazyKeyedCollectionMark2 item 1&#39;</p>
<p>09:23:59.1807+10:00</p>
<p>Created entity &#39;LazyKeyedCollectionMark2 item 2&#39;</p>
<p>09:23:59.1827+10:00</p>
<p>Created entity &#39;LazyKeyedCollectionMark2 item 3&#39;</p>
<p>09:23:59.1847+10:00</p>
<p>Created entity &#39;LazyKeyedCollectionMark2 item 4&#39;</p>
<p>09:23:59.1857+10:00</p>
<p>Created entity &#39;LazyKeyedCollectionMark2 item 5&#39;</p>
<p>09:23:59.1877+10:00</p>
<p>Created entity &#39;LazyKeyedCollectionMark2 item 6&#39;</p>
<p>09:23:59.1887+10:00</p>
<p>Created entity &#39;LazyKeyedCollectionMark2 item 7&#39;</p>
<p>09:23:59.1907+10:00</p>
<p>Created entity &#39;LazyKeyedCollectionMark2 item 8&#39;</p>
<p>09:23:59.1907+10:00</p>
<p>Created entity &#39;LazyKeyedCollectionMark2 item 9&#39;</p>
<p>09:23:59.1927+10:00</p>
</blockquote>
<p>And you can see from the time stamp we&#39;re not creating each object until it&#39;s requested from the collection. This means that if we were to grab a subset we&#39;d not have some of the created at all!</p>
<h2>Conclusion</h2>
<p>Here we&#39;ve looked at how to use the <code>KeyedCollection</code> and <code>Lazy&lt;T&gt;</code> to create a lazy loaded collection which we can work with, and how we can ensure that the collection items are lazy loaded at time of enumeration.</p>
<p>You can grab the source from this blog post off <a href="http://bitbucket.org/slace/lazy-collections/">my bitbucket</a>.</p>
<h3>Footnote</h3>
<p>Although this implementation <em>works</em> it&#39;s not without drawbacks. If you&#39;re wanting to use LINQ you&#39;ll find that it works a little bit differently, you need to have an <em>*explicit implementation</em> of <code>IEnumerable&lt;T&gt;</code>, so you can replace the one which is defined by the superclass. This is all the committed code.</p>
<p>You&#39;d be much better off doing an implementation of <code>IDictionary</code> and <code>IList</code> on the same object, rather than trying to work with <code>KeyedCollection</code>. Because of the way the .NET framework classes implements the <code>IEnumerable</code> interface it&#39;s a lot harder to get access to the methods (they aren&#39;t virtual) so to override them you have to do your own explicit implementations of the interface and use the <code>new</code> keyword when you can.</p>

                        </article>
                    </div>
                    <div class="8u skel-cell-mainContent">
                        <article class="is-post">
                            <div id="disqus_thread"></div>
<script>
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
window.disqus_shortname = 'aaronpowell'; // required: replace example with your forum shortname
window.disqus_identifier = document.title || 'Home';
window.disqus_developer = !! ~document.location.href.indexOf("localhost") ? 1 : 0;
window.disqus_url = document.location.origin + '/lazy-keyedcollections';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by</a>
<span class="logo-disqus"> Disqus</span>

                        </article>
                    </div>
                </div>
            </div>
        </div>

        <div id="footer-wrapper">

    <!-- Copyright -->
        <div id="copyright" class="container">
            <ul class="links">
                <li>&copy; Aaron Powell. All rights reserved</li>
                <li>Design: <a href="http://html5up.net/">HTML5 UP</a></li>
            </ul>
        </div>

</div>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6399564-1']);
  _gaq.push(['_trackPageview']);

  (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script>

    </body>
</html>